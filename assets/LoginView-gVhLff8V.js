import{s as d}from"./sweetAlert-s8oRExvE.js";import{_ as w,c as y,a as o,b as l,w as b,r as u,o as v,n as m,p as C,f as k}from"./index-GsItRNTP.js";import"./sweetalert2.all-IALlFI-O.js";const _="https://two024-south-json-server-vercel.onrender.com",V={data(){return{user:{email:"",password:""},userCarts:[],cartsLength:0,isActive:!0}},methods:{async login(){event.preventDefault();try{const s=await this.axios.post(`${_}/login`,this.user),{accessToken:t,expired:a}=s.data,r=s.data.user.id;document.cookie=`hexTokenU=${t}; expires=${new Date(a).toUTCString()}`,document.cookie=`userId=${r}`,this.userIsLoggedIn2=!0,d.threeLayerCheckType("success","會員登入成功"),this.$emitter.emit("loginCheck2",!0),this.$router.push("/"),r&&(await this.getCarts(r),this.$emitter.emit("adminUpdateCart",this.cartsLength))}catch(s){console.error(s),d.threeLayerCheckType("error","會員登入失敗，請再次填寫會員登入資料")}},getCarts(s){return this.axios.get(`${_}/carts`).then(t=>{this.userCarts=t.data.filter(e=>e.userId===s);const a=[],r=new Set;this.userCarts.forEach(e=>{r.has(e.productId)||(r.add(e.productId),a.push(e))}),this.userCarts=a,this.cartsLength=this.userCarts.length}).catch(t=>{d.threeLayerCheckType("error","取得購物車資料失敗")})},toggleEye(){this.isActive=!this.isActive}},mounted(){window.scrollTo(0,0)}},n=s=>(C("data-v-8359d9ee"),s=s(),k(),s),I={class:"container py-10 py-lg-30"},x={class:"row justify-content-center align-items-cneter"},E={class:"col-md-6"},L=n(()=>o("h3",{class:"mb-4 text-center"},"會員登入",-1)),S={class:"form-floating mb-4"},T=n(()=>o("label",{for:"email"},"請輸入 Email",-1)),A={class:"form-floating mb-4"},U=n(()=>o("label",{for:"userpassword"},"請輸入Password",-1)),q=n(()=>o("button",{class:"btn-turquoise w-100 mt-4 btn-rounded",type:"submit",id:"login"}," 登入 ",-1));function F(s,t,a,r,e,c){const p=u("VeeField"),h=u("ErrorMessage"),g=u("VeeForm");return v(),y("div",I,[o("div",x,[o("div",E,[L,l(g,{id:"form",ref:"form",onSubmit:c.login},{default:b(({errors:f})=>[o("div",S,[l(p,{type:"email",name:"email",class:m(["form-control",{"is-invalid":f.email}]),modelValue:e.user.email,"onUpdate:modelValue":t[0]||(t[0]=i=>e.user.email=i),id:"email",placeholder:"請輸入 Email",rules:"email|required",autocomplete:"useremail"},null,8,["modelValue","class"]),T,l(h,{name:"email",class:"invalid-feedback"})]),o("div",A,[l(p,{type:e.isActive?"password":"text",class:m(["form-control",{"is-invalid":f.password}]),name:"password",id:"userpassword",placeholder:"請輸入Password",rules:"min:8|alpha_dash|required",autocomplete:"current-password",modelValue:e.user.password,"onUpdate:modelValue":t[1]||(t[1]=i=>e.user.password=i)},null,8,["type","class","modelValue"]),U,o("button",{class:"fs-3 fs-lg-2 bg-transparent border-0 form-eye",type:"button",onClick:t[2]||(t[2]=(...i)=>c.toggleEye&&c.toggleEye(...i)),"aria-label":"eyesClick"},[o("i",{class:m([e.isActive?"bi-eye-fill":"bi-eye-slash-fill","bi"])},null,2)]),l(h,{name:"password",class:"invalid-feedback"})]),q]),_:1},8,["onSubmit"])])])])}const D=w(V,[["render",F],["__scopeId","data-v-8359d9ee"]]);export{D as default};
