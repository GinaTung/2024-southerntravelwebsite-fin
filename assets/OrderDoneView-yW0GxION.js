import{U as v}from"./UserProductModal-_J9yqdrj.js";import{C}from"./CartNavbar-9ARdlP2u.js";import{C as h}from"./collapse-JrxR3zfW.js";import{_ as x,c,a as s,b as u,d as n,t as r,f as p,v as _,F as b,h as y,n as I,r as g,o as a}from"./index-cq87140S.js";const f="http://localhost:3000",k={components:{CartNavbar:C,UserProductModal:v},data(){return{userId:"",total:0,cartsData:[],userCart:[],isOpen:!0,isOrderOpen:!0,headerCollapse:{},products:[],product:{},cartTotal:0,orderData:[],userOrder:"",product_id:"",productId:"",productTitle:"",orderId:0}},watch:{$route(){this.headerCollapse.hide(),this.orderCollapse.hide()}},methods:{backPage(){this.$router.go(-1)},toggleOpen(){this.isOpen=!this.isOpen},toggleOpenOrder(){this.isOrderOpen=!this.isOrderOpen},forId(t,o){this.productId=t,this.productTitle=o,this.$refs.userProductModal.openModal()},getOderData(){this.axios.get(`${f}/orders`).then(t=>{this.orderData=t.data,this.orderData.forEach(o=>{o.user.userId===this.userId&&o.status===!1&&(this.userOrder=o.user)})}).catch(t=>{console.log(t)})},getCart(){this.axios.get(`${f}/cartsData`).then(t=>{this.cartsData=t.data,this.cartsData.forEach(o=>{o.orderStatus===!1&&o.orderId===this.orderId&&o.data.forEach(i=>{i.userId===this.userId&&this.userCart.push(i)})}),this.userCart.forEach(o=>{this.total+=o.final_total})}).catch(t=>{console.log(t)})},getCookie(t){const i=`; ${document.cookie}`.split(`; ${t}=`);if(i.length===2)return i.pop().split(";").shift()},thousand(t){return t!==void 0&&(t=t.toString().replace(new RegExp("\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))","g"),",")),`$ ${t}`}},mounted(){const t=this.getCookie("userId");this.userId=t*1;const o=this.getCookie("orderId");this.orderId=o*1,this.getOderData(),this.getCart(),this.headerCollapse=new h(this.$refs.headerCollapse,{toggle:!1}),this.orderCollapse=new h(this.$refs.orderCollapse,{toggle:!1})}},w={class:"container py-10 py-lg-30"},D={class:"row"},E={class:"col-md-6 mx-auto pb-5 pb-lg-15"},M=s("div",{class:"text-center mb-10"},[s("div",{class:"text-center"},[s("i",{class:"bi bi-check-circle-fill text-success fs-3"}),s("p",{class:"fs-4"},"感謝您！您的訂單已建立完成")])],-1),T={class:"row"},N={class:"mb-4"},P={class:"d-grid gap-2"},U=s("br",null,null,-1),B={key:0,class:"bi bi-chevron-down"},S={key:1,class:"bi bi-chevron-up"},V={class:"collapse show",id:"collapseExample",ref:"headerCollapse"},q={class:"card card-body rounded-0"},j={class:"col-12 col-md-5 col-lg-4"},F=["src","alt"],z={class:"col-12 col-md-7 col-lg-8 d-flex flex-column justify-content-between"},L={class:"mt-4 mt-md-0 mb-4"},A={class:"mb-4"},G={class:"mb-4"},H={class:"mb-4"},J=["onClick"],K={class:"mb-4 col-12"},Q={class:"d-grid gap-2"},R=s("br",null,null,-1),W={key:0,class:"bi bi-chevron-down"},X={key:1,class:"bi bi-chevron-up"},Y={class:"collapse show",id:"collapseOrder",ref:"orderCollapse"},Z={class:"card card-body rounded-0",style:{height:"350px"}},$={class:"row p-4 p-md-10"},ss={class:"col-12 col-md-6 col-lg-6"},es={class:"mb-4"},ts={class:"mb-4"},os={class:"mb-4"},rs={class:"mb-4"},ls={class:"mb-4"},ds={class:"col-12 col-md-6 col-lg-6"},cs={class:"mb-4"},as={class:"mb-4"},is={class:"mb-4"},ns=s("div",{class:"d-flex justify-content-center"},[s("div",{class:"w-100 w-md-25"},[s("a",{class:"btn-square mt-4 fs-5 w-100",type:"button",href:"#"},"回首頁")])],-1);function hs(t,o,i,us,e,d){const m=g("CartNavbar"),O=g("UserProductModal");return a(),c(b,null,[s("div",w,[s("div",D,[s("div",E,[u(m)])]),M,s("div",T,[s("div",N,[s("p",P,[s("button",{class:"btn btn-primary-600 border-top",type:"button","data-bs-toggle":"collapse","data-bs-target":"#collapseExample","aria-expanded":"false","aria-controls":"collapseExample",onClick:o[0]||(o[0]=(...l)=>d.toggleOpen&&d.toggleOpen(...l))},[n(" 總計："+r(d.thousand(e.total))+"元",1),U,n("購買清單 "),e.isOpen===!1?(a(),c("i",B)):(a(),c("i",S))])]),p(s("div",V,[s("div",q,[(a(!0),c(b,null,y(e.userCart,l=>(a(),c("div",{class:"row p-4 p-md-10",key:l.id},[s("div",j,[s("img",{src:l.product.imageUrl,alt:l.product.title,class:"img-fluid h-100"},null,8,F)]),s("div",z,[s("div",null,[s("h4",L,"套裝行程名稱："+r(l.product.title),1),s("h5",A,"單價："+r(d.thousand(l.product.price)),1),s("h5",G,"預約數量："+r(l.qty)+" 位",1),s("h5",H,"總計："+r(d.thousand(l.final_total)),1)]),s("div",null,[s("button",{type:"button",class:"btn-turquoise border-0 rounded-1",onClick:ps=>d.forId(l.product.id,l.product.title)}," 查看更多 ",8,J)])])]))),128))])],512),[[_,e.isOpen]])]),s("div",K,[s("p",Q,[s("button",{class:"btn btn-primary-600 border-top",type:"button","data-bs-toggle":"collapse","data-bs-target":"#collapseOrder","aria-expanded":"true","aria-controls":"collapseOrder",onClick:o[1]||(o[1]=(...l)=>d.toggleOpenOrder&&d.toggleOpenOrder(...l))},[n(" 訂單資料及收件方式"),R,e.isOrderOpen===!1?(a(),c("i",W)):(a(),c("i",X))])]),p(s("div",Y,[s("div",Z,[s("div",$,[s("div",ss,[s("h5",es," 主要聯繫人名字："+r(e.userOrder.name)+" "+r(e.userOrder.appellation==="female"?"女士":"男士"),1),s("h5",ts,"主要聯繫人電話："+r(e.userOrder.tel),1),s("h5",os,"主要聯繫人身分證字號："+r(e.userOrder.memberId),1),s("h5",rs,"主要聯繫人護照號碼："+r(e.userOrder.passport),1),s("h5",ls,"主要聯繫人地址："+r(e.userOrder.address),1)]),s("div",ds,[s("h5",cs,"收取方式："+r(e.userOrder.shippingMethod),1),s("h5",as,"付款方式："+r(e.userOrder.payMethod),1),s("h5",is,[n(" 付款狀態： "),s("span",{class:I({"text-danger":e.userOrder.status===!1,"text-success":e.userOrder.status===!0})},r(e.userOrder.status?"已付款":"未付款"),3)]),s("h5",null,"備註："+r(e.userOrder.comment),1)])])])],512),[[_,e.isOrderOpen]])])]),ns]),u(O,{ref:"userProductModal",userCart:e.userCart,productId:e.productId,productTitle:e.productTitle},null,8,["userCart","productId","productTitle"])],64)}const ms=x(k,[["render",hs]]);export{ms as default};
