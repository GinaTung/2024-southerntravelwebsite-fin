import{b as K,c as G,d as Q,f as Z,n as O,h as V,S as ee,a as te,N as se}from"./navigation-QNcPvEtI.js";import{s as q}from"./sweetAlert-uqvRwuY4.js";import{_ as ae,o as P,c as A,a as c,t as B,b as j,w as R,F as N,h as W,g as X,k as Y,d as ie,r as U,p as ne,i as le}from"./index-UAeLte_V.js";function z(i){return i===void 0&&(i=""),`.${i.trim().replace(/([\.:!+\/])/g,"\\$1").replace(/ /g,".")}`}function re(i){let{swiper:e,extendParams:L,on:m,emit:v}=i;const d="swiper-pagination";L({pagination:{el:null,bulletElement:"span",clickable:!1,hideOnClick:!1,renderBullet:null,renderProgressbar:null,renderFraction:null,renderCustom:null,progressbarOpposite:!1,type:"bullets",dynamicBullets:!1,dynamicMainBullets:1,formatFractionCurrent:s=>s,formatFractionTotal:s=>s,bulletClass:`${d}-bullet`,bulletActiveClass:`${d}-bullet-active`,modifierClass:`${d}-`,currentClass:`${d}-current`,totalClass:`${d}-total`,hiddenClass:`${d}-hidden`,progressbarFillClass:`${d}-progressbar-fill`,progressbarOppositeClass:`${d}-progressbar-opposite`,clickableClass:`${d}-clickable`,lockClass:`${d}-lock`,horizontalClass:`${d}-horizontal`,verticalClass:`${d}-vertical`,paginationDisabledClass:`${d}-disabled`}}),e.pagination={el:null,bullets:[]};let S,C=0;const n=s=>(Array.isArray(s)||(s=[s].filter(t=>!!t)),s);function y(){return!e.params.pagination.el||!e.pagination.el||Array.isArray(e.pagination.el)&&e.pagination.el.length===0}function o(s,t){const{bulletActiveClass:a}=e.params.pagination;s&&(s=s[`${t==="prev"?"previous":"next"}ElementSibling`],s&&(s.classList.add(`${a}-${t}`),s=s[`${t==="prev"?"previous":"next"}ElementSibling`],s&&s.classList.add(`${a}-${t}-${t}`)))}function $(s){const t=s.target.closest(z(e.params.pagination.bulletClass));if(!t)return;s.preventDefault();const a=G(t)*e.params.slidesPerGroup;if(e.params.loop){if(e.realIndex===a)return;const l=e.getSlideIndexByData(a),p=e.getSlideIndexByData(e.realIndex);l>e.slides.length-e.loopedSlides&&e.loopFix({direction:l>p?"next":"prev",activeSlideIndex:l,slideTo:!1}),e.slideToLoop(a)}else e.slideTo(a)}function w(){const s=e.rtl,t=e.params.pagination;if(y())return;let a=e.pagination.el;a=n(a);let l,p;const M=e.virtual&&e.params.virtual.enabled?e.virtual.slides.length:e.slides.length,g=e.params.loop?Math.ceil(M/e.params.slidesPerGroup):e.snapGrid.length;if(e.params.loop?(p=e.previousRealIndex||0,l=e.params.slidesPerGroup>1?Math.floor(e.realIndex/e.params.slidesPerGroup):e.realIndex):typeof e.snapIndex<"u"?(l=e.snapIndex,p=e.previousSnapIndex):(p=e.previousIndex||0,l=e.activeIndex||0),t.type==="bullets"&&e.pagination.bullets&&e.pagination.bullets.length>0){const r=e.pagination.bullets;let T,f,E;if(t.dynamicBullets&&(S=K(r[0],e.isHorizontal()?"width":"height",!0),a.forEach(u=>{u.style[e.isHorizontal()?"width":"height"]=`${S*(t.dynamicMainBullets+4)}px`}),t.dynamicMainBullets>1&&p!==void 0&&(C+=l-(p||0),C>t.dynamicMainBullets-1?C=t.dynamicMainBullets-1:C<0&&(C=0)),T=Math.max(l-C,0),f=T+(Math.min(r.length,t.dynamicMainBullets)-1),E=(f+T)/2),r.forEach(u=>{const h=[...["","-next","-next-next","-prev","-prev-prev","-main"].map(b=>`${t.bulletActiveClass}${b}`)].map(b=>typeof b=="string"&&b.includes(" ")?b.split(" "):b).flat();u.classList.remove(...h)}),a.length>1)r.forEach(u=>{const h=G(u);h===l?u.classList.add(...t.bulletActiveClass.split(" ")):e.isElement&&u.setAttribute("part","bullet"),t.dynamicBullets&&(h>=T&&h<=f&&u.classList.add(...`${t.bulletActiveClass}-main`.split(" ")),h===T&&o(u,"prev"),h===f&&o(u,"next"))});else{const u=r[l];if(u&&u.classList.add(...t.bulletActiveClass.split(" ")),e.isElement&&r.forEach((h,b)=>{h.setAttribute("part",b===l?"bullet-active":"bullet")}),t.dynamicBullets){const h=r[T],b=r[f];for(let D=T;D<=f;D+=1)r[D]&&r[D].classList.add(...`${t.bulletActiveClass}-main`.split(" "));o(h,"prev"),o(b,"next")}}if(t.dynamicBullets){const u=Math.min(r.length,t.dynamicMainBullets+4),h=(S*u-S)/2-E*S,b=s?"right":"left";r.forEach(D=>{D.style[e.isHorizontal()?b:"top"]=`${h}px`})}}a.forEach((r,T)=>{if(t.type==="fraction"&&(r.querySelectorAll(z(t.currentClass)).forEach(f=>{f.textContent=t.formatFractionCurrent(l+1)}),r.querySelectorAll(z(t.totalClass)).forEach(f=>{f.textContent=t.formatFractionTotal(g)})),t.type==="progressbar"){let f;t.progressbarOpposite?f=e.isHorizontal()?"vertical":"horizontal":f=e.isHorizontal()?"horizontal":"vertical";const E=(l+1)/g;let u=1,h=1;f==="horizontal"?u=E:h=E,r.querySelectorAll(z(t.progressbarFillClass)).forEach(b=>{b.style.transform=`translate3d(0,0,0) scaleX(${u}) scaleY(${h})`,b.style.transitionDuration=`${e.params.speed}ms`})}t.type==="custom"&&t.renderCustom?(r.innerHTML=t.renderCustom(e,l+1,g),T===0&&v("paginationRender",r)):(T===0&&v("paginationRender",r),v("paginationUpdate",r)),e.params.watchOverflow&&e.enabled&&r.classList[e.isLocked?"add":"remove"](t.lockClass)})}function x(){const s=e.params.pagination;if(y())return;const t=e.virtual&&e.params.virtual.enabled?e.virtual.slides.length:e.slides.length;let a=e.pagination.el;a=n(a);let l="";if(s.type==="bullets"){let p=e.params.loop?Math.ceil(t/e.params.slidesPerGroup):e.snapGrid.length;e.params.freeMode&&e.params.freeMode.enabled&&p>t&&(p=t);for(let M=0;M<p;M+=1)s.renderBullet?l+=s.renderBullet.call(e,M,s.bulletClass):l+=`<${s.bulletElement} ${e.isElement?'part="bullet"':""} class="${s.bulletClass}"></${s.bulletElement}>`}s.type==="fraction"&&(s.renderFraction?l=s.renderFraction.call(e,s.currentClass,s.totalClass):l=`<span class="${s.currentClass}"></span> / <span class="${s.totalClass}"></span>`),s.type==="progressbar"&&(s.renderProgressbar?l=s.renderProgressbar.call(e,s.progressbarFillClass):l=`<span class="${s.progressbarFillClass}"></span>`),e.pagination.bullets=[],a.forEach(p=>{s.type!=="custom"&&(p.innerHTML=l||""),s.type==="bullets"&&e.pagination.bullets.push(...p.querySelectorAll(z(s.bulletClass)))}),s.type!=="custom"&&v("paginationRender",a[0])}function _(){e.params.pagination=Q(e,e.originalParams.pagination,e.params.pagination,{el:"swiper-pagination"});const s=e.params.pagination;if(!s.el)return;let t;typeof s.el=="string"&&e.isElement&&(t=e.el.querySelector(s.el)),!t&&typeof s.el=="string"&&(t=[...document.querySelectorAll(s.el)]),t||(t=s.el),!(!t||t.length===0)&&(e.params.uniqueNavElements&&typeof s.el=="string"&&Array.isArray(t)&&t.length>1&&(t=[...e.el.querySelectorAll(s.el)],t.length>1&&(t=t.filter(a=>Z(a,".swiper")[0]===e.el)[0])),Array.isArray(t)&&t.length===1&&(t=t[0]),Object.assign(e.pagination,{el:t}),t=n(t),t.forEach(a=>{s.type==="bullets"&&s.clickable&&a.classList.add(s.clickableClass),a.classList.add(s.modifierClass+s.type),a.classList.add(e.isHorizontal()?s.horizontalClass:s.verticalClass),s.type==="bullets"&&s.dynamicBullets&&(a.classList.add(`${s.modifierClass}${s.type}-dynamic`),C=0,s.dynamicMainBullets<1&&(s.dynamicMainBullets=1)),s.type==="progressbar"&&s.progressbarOpposite&&a.classList.add(s.progressbarOppositeClass),s.clickable&&a.addEventListener("click",$),e.enabled||a.classList.add(s.lockClass)}))}function F(){const s=e.params.pagination;if(y())return;let t=e.pagination.el;t&&(t=n(t),t.forEach(a=>{a.classList.remove(s.hiddenClass),a.classList.remove(s.modifierClass+s.type),a.classList.remove(e.isHorizontal()?s.horizontalClass:s.verticalClass),s.clickable&&a.removeEventListener("click",$)})),e.pagination.bullets&&e.pagination.bullets.forEach(a=>a.classList.remove(...s.bulletActiveClass.split(" ")))}m("changeDirection",()=>{if(!e.pagination||!e.pagination.el)return;const s=e.params.pagination;let{el:t}=e.pagination;t=n(t),t.forEach(a=>{a.classList.remove(s.horizontalClass,s.verticalClass),a.classList.add(e.isHorizontal()?s.horizontalClass:s.verticalClass)})}),m("init",()=>{e.params.pagination.enabled===!1?k():(_(),x(),w())}),m("activeIndexChange",()=>{typeof e.snapIndex>"u"&&w()}),m("snapIndexChange",()=>{w()}),m("snapGridLengthChange",()=>{x(),w()}),m("destroy",()=>{F()}),m("enable disable",()=>{let{el:s}=e.pagination;s&&(s=n(s),s.forEach(t=>t.classList[e.enabled?"remove":"add"](e.params.pagination.lockClass)))}),m("lock unlock",()=>{w()}),m("click",(s,t)=>{const a=t.target,l=n(e.pagination.el);if(e.params.pagination.el&&e.params.pagination.hideOnClick&&l&&l.length>0&&!a.classList.contains(e.params.pagination.bulletClass)){if(e.navigation&&(e.navigation.nextEl&&a===e.navigation.nextEl||e.navigation.prevEl&&a===e.navigation.prevEl))return;const p=l[0].classList.contains(e.params.pagination.hiddenClass);v(p===!0?"paginationShow":"paginationHide"),l.forEach(M=>M.classList.toggle(e.params.pagination.hiddenClass))}});const H=()=>{e.el.classList.remove(e.params.pagination.paginationDisabledClass);let{el:s}=e.pagination;s&&(s=n(s),s.forEach(t=>t.classList.remove(e.params.pagination.paginationDisabledClass))),_(),x(),w()},k=()=>{e.el.classList.add(e.params.pagination.paginationDisabledClass);let{el:s}=e.pagination;s&&(s=n(s),s.forEach(t=>t.classList.add(e.params.pagination.paginationDisabledClass))),F()};Object.assign(e.pagination,{enable:H,disable:k,render:x,update:w,init:_,destroy:F})}function oe(i){let{swiper:e,extendParams:L,emit:m,once:v}=i;L({freeMode:{enabled:!1,momentum:!0,momentumRatio:1,momentumBounce:!0,momentumBounceRatio:1,momentumVelocityRatio:1,sticky:!1,minimumVelocity:.02}});function d(){if(e.params.cssMode)return;const n=e.getTranslate();e.setTranslate(n),e.setTransition(0),e.touchEventsData.velocities.length=0,e.freeMode.onTouchEnd({currentPos:e.rtl?e.translate:-e.translate})}function S(){if(e.params.cssMode)return;const{touchEventsData:n,touches:y}=e;n.velocities.length===0&&n.velocities.push({position:y[e.isHorizontal()?"startX":"startY"],time:n.touchStartTime}),n.velocities.push({position:y[e.isHorizontal()?"currentX":"currentY"],time:O()})}function C(n){let{currentPos:y}=n;if(e.params.cssMode)return;const{params:o,wrapperEl:$,rtlTranslate:w,snapGrid:x,touchEventsData:_}=e,H=O()-_.touchStartTime;if(y<-e.minTranslate()){e.slideTo(e.activeIndex);return}if(y>-e.maxTranslate()){e.slides.length<x.length?e.slideTo(x.length-1):e.slideTo(e.slides.length-1);return}if(o.freeMode.momentum){if(_.velocities.length>1){const g=_.velocities.pop(),r=_.velocities.pop(),T=g.position-r.position,f=g.time-r.time;e.velocity=T/f,e.velocity/=2,Math.abs(e.velocity)<o.freeMode.minimumVelocity&&(e.velocity=0),(f>150||O()-g.time>300)&&(e.velocity=0)}else e.velocity=0;e.velocity*=o.freeMode.momentumVelocityRatio,_.velocities.length=0;let k=1e3*o.freeMode.momentumRatio;const s=e.velocity*k;let t=e.translate+s;w&&(t=-t);let a=!1,l;const p=Math.abs(e.velocity)*20*o.freeMode.momentumBounceRatio;let M;if(t<e.maxTranslate())o.freeMode.momentumBounce?(t+e.maxTranslate()<-p&&(t=e.maxTranslate()-p),l=e.maxTranslate(),a=!0,_.allowMomentumBounce=!0):t=e.maxTranslate(),o.loop&&o.centeredSlides&&(M=!0);else if(t>e.minTranslate())o.freeMode.momentumBounce?(t-e.minTranslate()>p&&(t=e.minTranslate()+p),l=e.minTranslate(),a=!0,_.allowMomentumBounce=!0):t=e.minTranslate(),o.loop&&o.centeredSlides&&(M=!0);else if(o.freeMode.sticky){let g;for(let r=0;r<x.length;r+=1)if(x[r]>-t){g=r;break}Math.abs(x[g]-t)<Math.abs(x[g-1]-t)||e.swipeDirection==="next"?t=x[g]:t=x[g-1],t=-t}if(M&&v("transitionEnd",()=>{e.loopFix()}),e.velocity!==0){if(w?k=Math.abs((-t-e.translate)/e.velocity):k=Math.abs((t-e.translate)/e.velocity),o.freeMode.sticky){const g=Math.abs((w?-t:t)-e.translate),r=e.slidesSizesGrid[e.activeIndex];g<r?k=o.speed:g<2*r?k=o.speed*1.5:k=o.speed*2.5}}else if(o.freeMode.sticky){e.slideToClosest();return}o.freeMode.momentumBounce&&a?(e.updateProgress(l),e.setTransition(k),e.setTranslate(t),e.transitionStart(!0,e.swipeDirection),e.animating=!0,V($,()=>{!e||e.destroyed||!_.allowMomentumBounce||(m("momentumBounce"),e.setTransition(o.speed),setTimeout(()=>{e.setTranslate(l),V($,()=>{!e||e.destroyed||e.transitionEnd()})},0))})):e.velocity?(m("_freeModeNoMomentumRelease"),e.updateProgress(t),e.setTransition(k),e.setTranslate(t),e.transitionStart(!0,e.swipeDirection),e.animating||(e.animating=!0,V($,()=>{!e||e.destroyed||e.transitionEnd()}))):e.updateProgress(t),e.updateActiveIndex(),e.updateSlidesClasses()}else if(o.freeMode.sticky){e.slideToClosest();return}else o.freeMode&&m("_freeModeNoMomentumRelease");(!o.freeMode.momentum||H>=o.longSwipesMs)&&(e.updateProgress(),e.updateActiveIndex(),e.updateSlidesClasses())}Object.assign(e,{freeMode:{onTouchStart:d,onTouchMove:S,onTouchEnd:C}})}const J="https://two024-south-json-server-vercel.onrender.com",ce={components:{Swiper:ee,SwiperSlide:te},props:["adCategoryTitle","token","userId","currentDate"],data(){return{attractionTitle:"",attractions:[],enabledAttractions:[],adTitle:{attractions:"探索旅遊景點",packages:"探索旅遊方案"},isFavorite:{},linkPath:"",enabledProducts:[]}},methods:{goRouter(i){return`#/TouristAttractions/${i.category}/${i.title}`},goRouterProduct(i){return`#/TouristPackage/${i.category}/${i.title}`},getAttractions(){this.axios.get(`${J}/attractions`).then(i=>{this.attractions=i.data,this.enabledAttractions=this.attractions.filter(e=>e.is_enabled===1),this.removeAttractionWithTitle(this.attractionTitle)}).catch(i=>{q.threeLayerCheckType("error","取得景點資料失敗")})},removeAttractionWithTitle(i){i&&(this.enabledAttractions=this.enabledAttractions.filter(e=>e.title!==i))},getProducts(){this.axios.get(`${J}/products`).then(i=>{i.data.forEach(e=>{e.is_enabled===1&&this.enabledProducts.push(e)}),this.removeProductsWithTitle(this.attractionTitle)}).catch(()=>{this.isLoading=!1,q.threeLayerCheckType("error","取得產品資料失敗")})},removeProductsWithTitle(i){i&&(this.enabledProducts=this.enabledProducts.filter(e=>e.title!==i))},truncateContent(i,e){return i&&i.length>e?i.substring(0,e)+"...":i},thousand(i){return i!==void 0&&(i=i.toString().replace(new RegExp("\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))","g"),",")),`$ ${i}`}},setup(){return{modules:[oe,re,se]}},mounted(){this.attractionTitle=this.$route.params.title,this.linkPath=this.$route.name,this.getAttractions(),this.getProducts()}},I=i=>(ne("data-v-b8a0abc2"),i=i(),le(),i),de={key:0,class:"mt-10"},pe={class:"card h-100 flex-grow-1"},ue={class:"tag text-white"},fe=["href"],me=["src"],ge={class:"card-body"},he={class:"fs-5 fs-lg-4 fw-bold text-primary-700 text-center flex-grow-1 h-35"},ve=I(()=>c("button",{class:"swiper-button-next border-0 bg-transparent"},null,-1)),be=I(()=>c("button",{class:"swiper-button-prev border-0 bg-transparent"},null,-1)),ye={key:1,class:"mt-10"},xe={class:"card h-100 flex-grow-1"},Ce={class:"tag text-white"},_e=["href"],Te=["src"],we={class:"card-body"},ke={class:"fs-5 fw-bold text-primary-700 text-center flex-grow-1 h-45"},Me={class:"fs-6"},Be={class:"card-footer border-0"},Se={class:"d-flex align-items-center pb-2"},Pe={key:0},Le={class:"d-flex align-items-center mt-1"},Ae=I(()=>c("h5",{class:"text-danger fw-bold me-2"},"促銷價",-1)),$e={class:"text-danger"},De={key:1,class:"text-danger py-3"},Ee=I(()=>c("button",{class:"swiper-button-next border-0 bg-transparent"},null,-1)),ze=I(()=>c("button",{class:"swiper-button-prev border-0 bg-transparent"},null,-1));function Ie(i,e,L,m,v,d){const S=U("swiper-slide"),C=U("swiper");return P(),A(N,null,[v.linkPath==="TouristSingleAttraction"?(P(),A("div",de,[c("h2",null,B(v.adTitle[L.adCategoryTitle]),1),j(C,{slidesPerView:1,spaceBetween:10,breakpoints:{768:{slidesPerView:2,spaceBetween:20},992:{slidesPerView:3,spaceBetween:30}},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},pagination:{clickable:!0},modules:m.modules,class:"mySwiper4"},{default:R(()=>[(P(!0),A(N,null,W(v.enabledAttractions,(n,y)=>(P(),X(S,{key:y+123},{default:R(()=>[c("div",pe,[c("span",ue,B(n.category),1),c("a",{href:d.goRouter(n),target:"_blank",class:"stretched-link"},[c("img",{src:n.imageUrl,class:"img-fluid",alt:"attractionItem.title"},null,8,me)],8,fe),c("div",ge,[c("h5",he,B(n.title),1),c("p",null,B(d.truncateContent(n.description,48)),1)])])]),_:2},1024))),128)),ve,be]),_:1},8,["navigation","modules"])])):Y("",!0),v.linkPath==="TouristSinglePackage"?(P(),A("div",ye,[c("h2",null,B(v.adTitle[L.adCategoryTitle]),1),j(C,{slidesPerView:1,spaceBetween:10,breakpoints:{992:{slidesPerView:2,spaceBetween:20},1200:{slidesPerView:3,spaceBetween:30}},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},pagination:{clickable:!0},modules:m.modules,class:"mySwiper4"},{default:R(()=>[(P(!0),A(N,null,W(v.enabledProducts,(n,y)=>(P(),X(S,{key:y+123},{default:R(()=>[c("div",xe,[c("span",Ce,B(n.category),1),c("a",{href:d.goRouterProduct(n),target:"_blank",class:"stretched-link"},[c("img",{src:n.imageUrl,class:"img-fluid",alt:"productsItem.title"},null,8,Te)],8,_e),c("div",we,[c("h5",ke,B(n.title),1),c("p",Me,B(d.truncateContent(n.description,48)),1)]),c("div",Be,[c("div",Se,[L.currentDate<=n.endDate?(P(),A("h6",Pe,[ie(" 預約期間： "+B(n.startDate)+" 至 "+B(n.endDate)+" ",1),c("div",Le,[Ae,c("h5",$e,"NT"+B(d.thousand(n.price)),1)])])):(P(),A("h5",De," 預約時間已截止 "))])])])]),_:2},1024))),128)),Ee,ze]),_:1},8,["navigation","modules"])])):Y("",!0)],64)}const Oe=ae(ce,[["render",Ie],["__scopeId","data-v-b8a0abc2"]]);export{Oe as L,oe as f};
