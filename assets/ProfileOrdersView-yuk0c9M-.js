import{s as y}from"./sweetAlert-26C70qVf.js";import{_ as v,c as r,a as t,F as p,b as w,w as S,i as b,r as D,o as a,d as m,n as f,t as c,l as I,p as O,f as x}from"./index-d8UUWlQV.js";const C="https://two024-south-json-server-vercel.onrender.com",N={data(){return{userId:"",token:"",orders:[],orderNum:"",orderDate:"",finalTotal:"",isOpen:!1,selectedOrder:null,cartsData:"",ordersLength:"",status:{loadingItem:!1}}},methods:{showDetails(s){this.selectedOrder=this.selectedOrder===s?-1:s},getNewOrderNum(s){var o=new Date(s.user.create_at),h=o.toISOString(),u=h.slice(0,10),l=u.replace(/-/g,"");return l+this.formatId(s.id)},getOrderNum(s){return this.formatId(s.id)},getOrderDate(s){var o=new Date(s.user.create_at),h=o.toISOString(),u=h.slice(0,10);return u},formatId(s){return s.toString().padStart(3,"0")},getOrders(){this.status.loadingItem=!0,this.axios.get(`${C}/orders?_embed=cartsData`).then(s=>{this.orders=s.data.filter(o=>o.user.userId===this.userId),this.status.loadingItem=!1,this.ordersLength=this.orders.length}).catch(s=>{y.threeLayerCheckType("error","取得會員訂單資料失敗")})},thousand(s){return s!==void 0&&(s=s.toString().replace(new RegExp("\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))","g"),",")),`$ ${s}`},getCookie(s){const o=document.cookie.split(";");for(let h of o){const[u,l]=h.trim().split("=");if(u===s)return l}return null}},mounted(){window.scrollTo(0,0),this.isLoading=!0;const s=this.getCookie("userId"),o=this.getCookie("hexTokenU");this.userId=s*1,this.token=o,this.getOrders()}},i=s=>(O("data-v-075d56b4"),s=s(),x(),s),T={class:"table table-bordered table-hover"},L=i(()=>t("thead",null,[t("tr",{class:"bg-primary-400 align-middle fs-7 fs-md-6 text-center"},[t("th",{scope:"col"},"序號"),t("th",{scope:"col",class:"mw-2"},"訂單編號"),t("th",{scope:"col",class:"mw-2"},"訂購日期"),t("th",{scope:"col",class:"mw-2"},"購買金額"),t("th",{scope:"col",class:"mw-2"},"訂單狀態"),t("th",{scope:"col",class:"mw-1"},"操作")])],-1)),V={key:0,class:"text-center"},q=i(()=>t("td",{colspan:"6"},[t("div",{class:"spinner-border m-10",role:"status",style:{width:"3rem",height:"3rem",color:"#43b8bd"}},[t("span",{class:"visually-hidden"},"Loading...")])],-1)),B=[q],P={key:1,class:"table-style"},j={colspan:"6",class:"table-hover-style p-10"},F=i(()=>t("p",{class:"text-center mb-5 fs-5"},[m(" 目前沒有可用的訂單資料。"),t("br"),m("欲查看旅遊方案或進行購買，請點擊下方的連結。 ")],-1)),U={class:"d-flex justify-content-center"},z={scope:"row",class:"align-middle text-center fs-8 fs-md-6"},A={class:"align-middle fs-8 fs-md-6"},E={class:"align-middle fs-8 fs-md-6"},G={class:"align-middle fs-8 fs-md-6"},H={class:"align-middle fs-8 fs-md-6"},J={key:0,class:"text-primary-emphasis"},K={key:1,class:"text-primary"},M={key:2,class:"text-warning"},Q={key:3,class:"text-danger"},R={key:4,class:"text-success"},W={class:"align-middle"},X=["onClick"],Y=["onClick"],Z=i(()=>t("tr",null,[t("td",{colspan:"6",class:"table-hover-style border-0"})],-1)),$=i(()=>t("tr",null,[t("td",{class:"table-hover-style border-left-trans"}),t("th",{colspan:"5",class:"align-middle text-center bg-primary-200"},"購買訂單資料")],-1)),tt=i(()=>t("tr",null,[t("td",{class:"table-hover-style border-left-trans"}),t("td",{colspan:"2",class:"bg-primary-300"},"產品名稱"),t("td",{class:"bg-primary-300"},"單價"),t("td",{class:"bg-primary-300"},"數量"),t("td",{class:"bg-primary-300"},"小計")],-1)),st=i(()=>t("td",{colspan:"1",class:"table-hover-style border-left-trans border-bottom-trans"},null,-1)),et={colspan:"2",class:"fs-8 fs-md-6"},rt={class:"fs-8 fs-md-6"},at={class:"fs-8 fs-md-6"},ot={class:"fs-8 fs-md-6"};function lt(s,o,h,u,l,d){const g=D("router-link");return a(),r("table",T,[L,t("tbody",null,[l.ordersLength===0?(a(),r(p,{key:0},[l.status.loadingItem?(a(),r("tr",V,B)):(a(),r("tr",P,[t("td",j,[F,t("div",U,[w(g,{to:"/TouristPackage",class:"btn-turquoise w-100 w-md-25 text-center"},{default:S(()=>[m("南部旅遊方案")]),_:1})])])]))],64)):(a(!0),r(p,{key:1},b(l.orders,(e,n)=>(a(),r(p,{key:n+123},[t("tr",{class:f(["table-style",{"bg-active":l.selectedOrder===n}])},[t("th",z,c(n+1),1),t("td",A,c(d.getNewOrderNum(e)),1),t("td",E,c(d.getOrderDate(e)),1),t("td",G,c(d.thousand(e.cartsData[0].final_total)),1),t("td",H,[!e.status&&!e.billStatus&&!e.checkDataStatus&&!e.user.status?(a(),r("span",J," 訂單處理中 ")):!e.status&&!e.billStatus&&!e.checkDataStatus&&e.user.status?(a(),r("span",K," 預約安排出遊 ")):!e.status&&!e.billStatus&&e.checkDataStatus&&e.user.status?(a(),r("span",M," 發票開立中 ")):!e.status&&e.billStatus&&e.checkDataStatus&&e.user.status?(a(),r("span",Q," 訂單即將完成，準備出遊 ")):(a(),r("span",R,"已出遊結束"))]),t("td",W,[t("button",{class:"btn-outline-turquoise w-100 d-none d-md-block",type:"button",onClick:_=>d.showDetails(n)}," 查看詳情 ",8,X),t("button",{class:"btn-outline-turquoise w-100 d-md-none",type:"button",onClick:_=>d.showDetails(n)}," 詳情 ",8,Y)])],2),l.selectedOrder===n?(a(),r(p,{key:0},[Z,$,tt,(a(!0),r(p,null,b(e.cartsData[0].data,(_,k)=>(a(),r("tr",{key:k+123},[st,t("td",et,c(_.product.title),1),t("td",rt,c(d.thousand(_.price)),1),t("td",at,c(_.qty),1),t("td",ot,c(d.thousand(_.final_total)),1)]))),128)),t("tr",null,[t("td",{colspan:"6",class:f(["border-0 border-left-trans table-hover-style",{"border-bottom-trans":n===l.ordersLength-1}])},null,2)])],64)):I("",!0)],64))),128))])])}const nt=v(N,[["render",lt],["__scopeId","data-v-075d56b4"]]);export{nt as default};
