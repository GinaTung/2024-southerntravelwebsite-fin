import{g as q,i as z,e as H,S as G,a as J,N as K}from"./navigation-DpBJxq1p.js";import{f as Q,L as R}from"./LikeBlock-fKcldbiO.js";import{s as _}from"./sweetAlert-glx7s6ZD.js";import{_ as F,l as W,o as l,c as u,b as T,w as A,F as v,h as y,g as V,a as o,r as k,p as j,i as M,f as E,v as O,t as S,n as X,d as D,k as P}from"./index-JVIXtFAC.js";import{B as Y}from"./BannerBlock-HJ1vWMeD.js";function Z(t){let{swiper:e,extendParams:d,on:c}=t;d({thumbs:{swiper:null,multipleActiveThumbs:!0,autoScrollOffset:0,slideThumbActiveClass:"swiper-slide-thumb-active",thumbsContainerClass:"swiper-thumbs"}});let i=!1,h=!1;e.thumbs={swiper:null};function x(){const r=e.thumbs.swiper;if(!r||r.destroyed)return;const s=r.clickedIndex,n=r.clickedSlide;if(n&&n.classList.contains(e.params.thumbs.slideThumbActiveClass)||typeof s>"u"||s===null)return;let p;r.params.loop?p=parseInt(r.clickedSlide.getAttribute("data-swiper-slide-index"),10):p=s,e.params.loop?e.slideToLoop(p):e.slideTo(p)}function g(){const{thumbs:r}=e.params;if(i)return!1;i=!0;const s=e.constructor;if(r.swiper instanceof s)e.thumbs.swiper=r.swiper,Object.assign(e.thumbs.swiper.originalParams,{watchSlidesProgress:!0,slideToClickedSlide:!1}),Object.assign(e.thumbs.swiper.params,{watchSlidesProgress:!0,slideToClickedSlide:!1}),e.thumbs.swiper.update();else if(z(r.swiper)){const n=Object.assign({},r.swiper);Object.assign(n,{watchSlidesProgress:!0,slideToClickedSlide:!1}),e.thumbs.swiper=new s(n),h=!0}return e.thumbs.swiper.el.classList.add(e.params.thumbs.thumbsContainerClass),e.thumbs.swiper.on("tap",x),!0}function b(r){const s=e.thumbs.swiper;if(!s||s.destroyed)return;const n=s.params.slidesPerView==="auto"?s.slidesPerViewDynamic():s.params.slidesPerView;let p=1;const a=e.params.thumbs.slideThumbActiveClass;if(e.params.slidesPerView>1&&!e.params.centeredSlides&&(p=e.params.slidesPerView),e.params.thumbs.multipleActiveThumbs||(p=1),p=Math.floor(p),s.slides.forEach(f=>f.classList.remove(a)),s.params.loop||s.params.virtual&&s.params.virtual.enabled)for(let f=0;f<p;f+=1)H(s.slidesEl,`[data-swiper-slide-index="${e.realIndex+f}"]`).forEach(m=>{m.classList.add(a)});else for(let f=0;f<p;f+=1)s.slides[e.realIndex+f]&&s.slides[e.realIndex+f].classList.add(a);const w=e.params.thumbs.autoScrollOffset,I=w&&!s.params.loop;if(e.realIndex!==s.realIndex||I){const f=s.activeIndex;let m,L;if(s.params.loop){const U=s.slides.filter($=>$.getAttribute("data-swiper-slide-index")===`${e.realIndex}`)[0];m=s.slides.indexOf(U),L=e.activeIndex>e.previousIndex?"next":"prev"}else m=e.realIndex,L=m>e.previousIndex?"next":"prev";I&&(m+=L==="next"?w:-1*w),s.visibleSlidesIndexes&&s.visibleSlidesIndexes.indexOf(m)<0&&(s.params.centeredSlides?m>f?m=m-Math.floor(n/2)+1:m=m+Math.floor(n/2)-1:m>f&&s.params.slidesPerGroup,s.slideTo(m,r?0:void 0))}}c("beforeInit",()=>{const{thumbs:r}=e.params;if(!(!r||!r.swiper))if(typeof r.swiper=="string"||r.swiper instanceof HTMLElement){const s=q(),n=()=>{const a=typeof r.swiper=="string"?s.querySelector(r.swiper):r.swiper;if(a&&a.swiper)r.swiper=a.swiper,g(),b(!0);else if(a){const w=I=>{r.swiper=I.detail[0],a.removeEventListener("init",w),g(),b(!0),r.swiper.update(),e.update()};a.addEventListener("init",w)}return a},p=()=>{if(e.destroyed)return;n()||requestAnimationFrame(p)};requestAnimationFrame(p)}else g(),b(!0)}),c("slideChange update resize observerUpdate",()=>{b()}),c("setTransition",(r,s)=>{const n=e.thumbs.swiper;!n||n.destroyed||n.setTransition(s)}),c("beforeDestroy",()=>{const r=e.thumbs.swiper;!r||r.destroyed||h&&r.destroy()}),Object.assign(e.thumbs,{init:g,update:b})}const ee="https://two024-south-json-server-vercel.onrender.com",te={components:{Swiper:G,SwiperSlide:J},data(){return{attractionTitle:"",attractions:[],enabledAttractions:[],imagesUrl:""}},methods:{getAttractions(){this.axios.get(`${ee}/attractions`).then(t=>{this.attractions=t.data,this.attractions.forEach(e=>{e.is_enabled===1&&this.attractionTitle===e.title&&this.enabledAttractions.push(e)}),this.imagesUrl=this.enabledAttractions[0].imagesUrl}).catch(t=>{_.threeLayerCheckType("error","取得景點資料失敗")})}},setup(){const t=W(null);return{thumbsSwiper:t,setThumbsSwiper:d=>{t.value=d},modules:[Q,K,Z]}},mounted(){this.attractionTitle=this.$route.params.title,this.getAttractions()}},N=t=>(j("data-v-c53f480c"),t=t(),M(),t),se=["src"],re=N(()=>o("button",{class:"swiper-button-next border-0 bg-transparent"},null,-1)),ie=N(()=>o("button",{class:"swiper-button-prev border-0 bg-transparent"},null,-1)),oe=["src"];function ne(t,e,d,c,i,h){const x=k("swiper-slide"),g=k("swiper");return l(),u(v,null,[T(g,{spaceBetween:10,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},thumbs:{swiper:c.thumbsSwiper},modules:c.modules,class:"mySwiper2"},{default:A(()=>[(l(!0),u(v,null,y(i.imagesUrl,(b,r)=>(l(),V(x,{key:r+123},{default:A(()=>[o("img",{src:b,class:"img-fluid"},null,8,se)]),_:2},1024))),128)),re,ie]),_:1},8,["navigation","thumbs","modules"]),T(g,{onSwiper:c.setThumbsSwiper,spaceBetween:10,slidesPerView:4,freeMode:!0,watchSlidesProgress:!0,modules:c.modules,class:"mySwiper3"},{default:A(()=>[(l(!0),u(v,null,y(i.imagesUrl,(b,r)=>(l(),V(x,{key:r+123},{default:A(()=>[o("img",{src:b,class:"img-fluid"},null,8,oe)]),_:2},1024))),128))]),_:1},8,["onSwiper","modules"])],64)}const ae=F(te,[["render",ne],["__scopeId","data-v-c53f480c"]]),C="https://two024-south-json-server-vercel.onrender.com",ce={components:{singleAttraction:ae,BannerBlock:Y,LikeBlock:R},data(){return{category:"",attractionTitle:"",attractions:[],enabledAttractions:[],newAttractionsContent:"",newAttractionsTimeOpen:"",attractionId:"",heartData:[],isFavorite:{},userId:"",token:"",isLoading:!1}},methods:{redirectToA(t){this.$router.push({path:"/TouristAttractions",query:{category:t}})},getHeartData(){this.axios.get(`${C}/hearts`).then(t=>{t.data.forEach(e=>{e.userId===this.userId&&e.tag==="旅遊景點"&&(this.isFavorite[e.product]=!0)})}).catch(t=>{_.threeLayerCheckType("error","取得愛心收藏資料失敗")})},toggleFavorite(t,e,d){this.token?this.axios.get(`${C}/hearts`).then(c=>{const i=c.data.find(h=>h.product===t&&h.userId===this.userId&&h.tag==="旅遊景點");i?this.axios.delete(`${C}/hearts/${i.id}`).then(h=>{this.isFavorite[t]=!1,_.threeLayerCheckType("success",`取消收藏 ${d} 成功`),this.getHeartData()}).catch(h=>{_.threeLayerCheckType("error","取消收藏資料失敗")}):this.axios.post(`${C}/hearts`,{product:t,category:e,title:d,userId:this.userId,tag:"旅遊景點"}).then(h=>{this.isFavorite[t]=!0,_.threeLayerCheckType("success",`已加入收藏 ${d} 成功`),this.getHeartData()}).catch(h=>{_.threeLayerCheckType("error","收藏資料失敗")})}).catch(c=>{_.threeLayerCheckType("error","取得愛心收藏資料失敗")}):_.threeLayerCheckType("warning","請登入會員後，才能加入收藏")},getAttractions(){this.axios.get(`${C}/attractions`).then(t=>{this.attractions=t.data,this.attractions.forEach(e=>{e.is_enabled===1&&this.attractionTitle===e.title&&(this.enabledAttractions.push(e),this.attractionId=e.id,this.isLoading=!1)}),this.getNewText(),this.getnewAttractionsTimeOpen()}).catch(()=>{_.threeLayerCheckType("error","取得景點資料失敗")})},getNewText(){const t={};this.attractions.forEach(e=>{e.content&&e.content.split(";").forEach(c=>{const i=c.trim();t[e.id]||(t[e.id]=[]),t[e.id].push(i)})}),this.newProductsContent=Object.entries(t).map(([e,d])=>({id:e,content:d}))},getnewAttractionsTimeOpen(){const t={};this.attractions.forEach(e=>{e.content&&e.timeOpen.split(";").forEach(c=>{const i=c.trim();t[e.id]||(t[e.id]=[]),t[e.id].push(i)})}),this.newAttractionsTimeOpen=Object.entries(t).map(([e,d])=>({id:e,content:d}))},getCookie(t){const e=document.cookie.split(";");for(let d of e){const[c,i]=d.trim().split("=");if(c===t)return i}return null}},mounted(){this.category=this.$route.params.category,this.attractionTitle=this.$route.params.title;const t=this.getCookie("userId"),e=this.getCookie("hexTokenU");this.userId=t*1,this.token=e,this.isLoading=!0,this.getAttractions(),this.getHeartData(),window.scrollTo(0,0)}},B=t=>(j("data-v-008c4280"),t=t(),M(),t),le={class:"container py-10 py-lg-30 px-lg-20"},de={style:{"--bs-breadcrumb-divider":"'>'"},"aria-label":"breadcrumb",class:"pb-5 pb-lg-15"},ue={class:"breadcrumb mb-0 fs-5"},he={class:"breadcrumb-item"},pe={class:"breadcrumb-item"},me={class:"breadcrumb-item"},fe={class:"breadcrumb-item"},be={class:"intr-title d-flex align-items-center mb-4 fs-3 border-start border-primary-500 border-3"},we={class:"fs-3 me-2 fw-bold ps-3"},ge={class:"fs-3 me-4 fw-bold"},_e={key:0},ve={class:"tourist-intr-content my-lg-10 my-5"},Te={class:"mb-8"},ye=B(()=>o("p",{class:"fs-5 fs-md-4 fw-bold mb-4"},"景點介紹",-1)),ke={class:"fs-6 fs-md-5"},xe={class:"mb-8"},Se=B(()=>o("span",{class:"fs-5 fs-md-4 mb-4 fw-bold"},"開放時間：",-1)),Ae={key:0},Ce=B(()=>o("p",{class:"fs-5 fs-md-4 mb-3 fw-bold"},"交通資訊：",-1)),Ie={class:"row"},Le={class:"d-flex col-12 col-lg-7 justify-content-between flex-column"},Ee={key:0},Oe={class:"col-12 col-lg-5"},Pe=["src"];function Be(t,e,d,c,i,h){const x=k("VueLoading"),g=k("BannerBlock"),b=k("router-link"),r=k("singleAttraction"),s=k("LikeBlock");return l(),u(v,null,[T(x,{active:i.isLoading,class:"text-center","z-index":1060},null,8,["active"]),T(g),o("div",le,[o("nav",de,[o("ol",ue,[o("li",he,[T(b,{to:"/",exact:"","active-class":"active-link"},{default:A(()=>[D("首頁")]),_:1})]),o("li",pe,[T(b,{exact:"","active-class":"active-link",to:{path:"/TouristAttractions",query:{category:"全部",page:"1"}}},{default:A(()=>[D(" 南部旅遊景點 ")]),_:1})]),o("li",me,[E(o("a",{onClick:e[0]||(e[0]=n=>h.redirectToA("台南")),class:"navbar-brand"},"台南",512),[[O,i.category==="台南"]]),E(o("a",{onClick:e[1]||(e[1]=n=>h.redirectToA("嘉義")),class:"navbar-brand"},"嘉義",512),[[O,i.category==="嘉義"]]),E(o("a",{onClick:e[2]||(e[2]=n=>h.redirectToA("高雄")),class:"navbar-brand"},"高雄",512),[[O,i.category==="高雄"]])]),o("li",fe,S(i.attractionTitle),1)])]),o("div",be,[o("span",we,S(i.category),1),o("p",ge,S(i.attractionTitle),1),o("button",{class:"border-0 heart4 fs-3",onClick:e[3]||(e[3]=n=>h.toggleFavorite(i.attractionId,i.category,i.attractionTitle)),type:"button"},[o("i",{class:X(["bi",{"bi-heart-fill":i.isFavorite[i.attractionId],"bi-heart":!i.isFavorite[i.attractionId]}])},null,2)])]),T(r),(l(!0),u(v,null,y(i.enabledAttractions,(n,p)=>(l(),u("div",{class:"row g-3",key:n.id},[p===0?(l(),u("div",_e,[o("div",ve,[o("div",Te,[ye,o("p",ke,S(n.description),1)]),o("div",xe,[Se,(l(!0),u(v,null,y(i.newAttractionsTimeOpen,a=>(l(),u("div",{key:a.id},[a.id===n.id?(l(),u("div",Ae,[(l(!0),u(v,null,y(a.content,w=>(l(),u("p",{key:w+123,class:"fs-6 fs-md-5 my-4"},S(w),1))),128))])):P("",!0)]))),128))]),o("div",null,[Ce,o("div",Ie,[o("div",Le,[(l(!0),u(v,null,y(t.newProductsContent,a=>(l(),u("div",{key:a.id},[a.id===n.id?(l(),u("div",Ee,[(l(!0),u(v,null,y(a.content,w=>(l(),u("p",{key:w,class:"fs-6 fs-md-5 my-4 mb-4"},S(w),1))),128))])):P("",!0)]))),128))]),o("div",Oe,[o("iframe",{src:n.imgMap,width:"100%",height:"100%",style:{border:"0"},allowfullscreen:"",loading:"lazy",referrerpolicy:"no-referrer-when-downgrade"},null,8,Pe)])])])])])):P("",!0)]))),128)),T(s,{adCategoryTitle:"attractions",token:i.token,"user-id":i.userId},null,8,["token","user-id"])])],64)}const Ne=F(ce,[["render",Be],["__scopeId","data-v-008c4280"]]);export{Ne as default};
