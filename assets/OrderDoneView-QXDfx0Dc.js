import{U as v}from"./UserProductModal-ZVK7O5ik.js";import{C}from"./CartNavbar-DDgxUZiB.js";import{C as h}from"./collapse-v9CPlyH7.js";import{_ as x,c as l,a as s,b as u,d as n,t as d,f as p,v as _,F as b,h as y,n as I,r as g,o as a}from"./index-3MCp_Jag.js";const f="https://two024-south-json-server-vercel.onrender.com",k={components:{CartNavbar:C,UserProductModal:v},data(){return{userId:"",total:0,cartsData:[],userCart:[],isOpen:!0,isOrderOpen:!0,headerCollapse:{},products:[],product:{},cartTotal:0,orderData:[],userOrder:"",product_id:"",productId:"",productTitle:"",orderId:0}},watch:{$route(){this.headerCollapse.hide(),this.orderCollapse.hide()}},methods:{backPage(){this.$router.go(-1)},toggleOpen(){this.isOpen=!this.isOpen},toggleOpenOrder(){this.isOrderOpen=!this.isOrderOpen},forId(e,t){this.productId=e,this.productTitle=t,this.$refs.userProductModal.openModal()},getOderData(){this.axios.get(`${f}/order`).then(e=>{this.orderData=e.data,this.orderData.forEach(t=>{t.user.userId===this.userId&&t.status===!1&&(this.userOrder=t.user)})}).catch(e=>{console.log(e)})},getCart(){this.axios.get(`${f}/cartsData`).then(e=>{this.cartsData=e.data,this.cartsData.forEach(t=>{t.orderStatus===!1&&t.orderId===this.orderId&&t.data.forEach(i=>{i.userId===this.userId&&this.userCart.push(i)})}),this.userCart.forEach(t=>{this.total+=t.final_total})}).catch(e=>{console.log(e)})},getCookie(e){const i=`; ${document.cookie}`.split(`; ${e}=`);if(i.length===2)return i.pop().split(";").shift()},thousand(e){return e!==void 0&&(e=e.toString().replace(new RegExp("\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))","g"),",")),`$ ${e}`}},mounted(){const e=this.getCookie("userId");this.userId=e*1;const t=this.getCookie("orderId");this.orderId=t*1,this.getOderData(),this.getCart(),this.headerCollapse=new h(this.$refs.headerCollapse,{toggle:!1}),this.orderCollapse=new h(this.$refs.orderCollapse,{toggle:!1})}},w={class:"container py-10 py-lg-30"},D={class:"row"},E={class:"col-md-6 mx-auto pb-5 pb-lg-15"},M=s("div",{class:"text-center mb-10"},[s("div",{class:"text-center"},[s("i",{class:"bi bi-check-circle-fill text-success fs-3"}),s("p",{class:"fs-4"},"感謝您！您的訂單已建立完成")])],-1),T={class:"row"},N={class:"mb-4"},P={class:"d-grid gap-2"},U=s("br",null,null,-1),B={key:0,class:"bi bi-chevron-down"},S={key:1,class:"bi bi-chevron-up"},V={class:"collapse show",id:"collapseExample",ref:"headerCollapse"},j={class:"card card-body rounded-0"},q={class:"col-12 col-md-5 col-lg-4"},F=["src","alt"],z={class:"col-12 col-md-7 col-lg-8 d-flex flex-column justify-content-between"},L={class:"mt-4 mt-md-0 mb-4"},A={class:"mb-4"},G={class:"mb-4"},H={class:"mb-4"},J=["onClick"],K={class:"mb-4 col-12"},Q={class:"d-grid gap-2"},R=s("br",null,null,-1),W={key:0,class:"bi bi-chevron-down"},X={key:1,class:"bi bi-chevron-up"},Y={class:"collapse show",id:"collapseOrder",ref:"orderCollapse"},Z={class:"card card-body rounded-0",style:{height:"350px"}},$={class:"row p-4 p-md-10"},ss={class:"col-12 col-md-5 col-lg-4"},es={class:"mb-4"},ts={class:"mb-4"},os={class:"mb-4"},rs={class:"col-12 col-md-7 col-lg-8"},ds={class:"mb-4"},cs={class:"mb-4"},ls={class:"mb-4"},as={class:"mb-4"},is=s("div",{class:"d-flex justify-content-center"},[s("div",{class:"w-100 w-md-25"},[s("a",{class:"btn-square mt-4 fs-5 w-100",type:"button",href:"#"},"回首頁")])],-1);function ns(e,t,i,hs,o,c){const m=g("CartNavbar"),O=g("UserProductModal");return a(),l(b,null,[s("div",w,[s("div",D,[s("div",E,[u(m)])]),M,s("div",T,[s("div",N,[s("p",P,[s("button",{class:"btn btn-primary-600 border-top",type:"button","data-bs-toggle":"collapse","data-bs-target":"#collapseExample","aria-expanded":"false","aria-controls":"collapseExample",onClick:t[0]||(t[0]=(...r)=>c.toggleOpen&&c.toggleOpen(...r))},[n(" 總計："+d(c.thousand(o.total))+"元",1),U,n("購買清單 "),o.isOpen===!1?(a(),l("i",B)):(a(),l("i",S))])]),p(s("div",V,[s("div",j,[(a(!0),l(b,null,y(o.userCart,r=>(a(),l("div",{class:"row p-4 p-md-10",key:r.id},[s("div",q,[s("img",{src:r.product.imageUrl,alt:r.product.title,class:"img-fluid h-100"},null,8,F)]),s("div",z,[s("div",null,[s("h4",L,"套裝行程名稱："+d(r.product.title),1),s("h5",A,"單價："+d(c.thousand(r.product.price)),1),s("h5",G,"預約數量："+d(r.qty)+" 位",1),s("h5",H,"總計："+d(c.thousand(r.final_total)),1)]),s("div",null,[s("button",{type:"button",class:"btn-turquoise border-0 rounded-1",onClick:us=>c.forId(r.product.id,r.product.title)}," 查看更多 ",8,J)])])]))),128))])],512),[[_,o.isOpen]])]),s("div",K,[s("p",Q,[s("button",{class:"btn btn-primary-600 border-top",type:"button","data-bs-toggle":"collapse","data-bs-target":"#collapseOrder","aria-expanded":"true","aria-controls":"collapseOrder",onClick:t[1]||(t[1]=(...r)=>c.toggleOpenOrder&&c.toggleOpenOrder(...r))},[n(" 訂單及運送資料"),R,o.isOrderOpen===!1?(a(),l("i",W)):(a(),l("i",X))])]),p(s("div",Y,[s("div",Z,[s("div",$,[s("div",ss,[s("h5",es,"收件人名字："+d(o.userOrder.name),1),s("h5",ts,"收件人電話："+d(o.userOrder.tel),1),s("h5",os,"備註："+d(o.userOrder.comment),1)]),s("div",rs,[s("h5",ds,"收件人地址："+d(o.userOrder.address),1),s("h5",cs,"運送方式："+d(o.userOrder.shippingMethod),1),s("h5",ls,"付款方式："+d(o.userOrder.payMethod),1),s("h5",as,[n("付款狀態： "),s("span",{class:I({"text-danger":o.userOrder.status===!1,"text-success":o.userOrder.status===!0})},d(o.userOrder.status?"已付款":"未付款"),3)])])])])],512),[[_,o.isOrderOpen]])])]),is]),u(O,{ref:"userProductModal",userCart:o.userCart,productId:o.productId,productTitle:o.productTitle},null,8,["userCart","productId","productTitle"])],64)}const fs=x(k,[["render",ns]]);export{fs as default};
