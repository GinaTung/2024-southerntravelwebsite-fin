import{g as X,i as Y,e as J,n as F,b as j,S as K,a as Q,N as W}from"./navigation-d_yBINsT.js";import{s as _}from"./sweetAlert-3mmwl4KR.js";import{_ as q,k as Z,o as p,c as b,b as S,w as C,F as x,h as M,g as H,a as o,r as I,f as N,v as z,t as A,n as ee,d as $,j as R}from"./index-jP5mHpEK.js";import{B as te}from"./BannerBlock-qPLDnGQ7.js";function se(i){let{swiper:e,extendParams:h,on:c}=i;h({thumbs:{swiper:null,multipleActiveThumbs:!0,autoScrollOffset:0,slideThumbActiveClass:"swiper-slide-thumb-active",thumbsContainerClass:"swiper-thumbs"}});let r=!1,f=!1;e.thumbs={swiper:null};function k(){const s=e.thumbs.swiper;if(!s||s.destroyed)return;const t=s.clickedIndex,m=s.clickedSlide;if(m&&m.classList.contains(e.params.thumbs.slideThumbActiveClass)||typeof t>"u"||t===null)return;let l;s.params.loop?l=parseInt(s.clickedSlide.getAttribute("data-swiper-slide-index"),10):l=t,e.params.loop?e.slideToLoop(l):e.slideTo(l)}function T(){const{thumbs:s}=e.params;if(r)return!1;r=!0;const t=e.constructor;if(s.swiper instanceof t)e.thumbs.swiper=s.swiper,Object.assign(e.thumbs.swiper.originalParams,{watchSlidesProgress:!0,slideToClickedSlide:!1}),Object.assign(e.thumbs.swiper.params,{watchSlidesProgress:!0,slideToClickedSlide:!1}),e.thumbs.swiper.update();else if(Y(s.swiper)){const m=Object.assign({},s.swiper);Object.assign(m,{watchSlidesProgress:!0,slideToClickedSlide:!1}),e.thumbs.swiper=new t(m),f=!0}return e.thumbs.swiper.el.classList.add(e.params.thumbs.thumbsContainerClass),e.thumbs.swiper.on("tap",k),!0}function u(s){const t=e.thumbs.swiper;if(!t||t.destroyed)return;const m=t.params.slidesPerView==="auto"?t.slidesPerViewDynamic():t.params.slidesPerView;let l=1;const n=e.params.thumbs.slideThumbActiveClass;if(e.params.slidesPerView>1&&!e.params.centeredSlides&&(l=e.params.slidesPerView),e.params.thumbs.multipleActiveThumbs||(l=1),l=Math.floor(l),t.slides.forEach(g=>g.classList.remove(n)),t.params.loop||t.params.virtual&&t.params.virtual.enabled)for(let g=0;g<l;g+=1)J(t.slidesEl,`[data-swiper-slide-index="${e.realIndex+g}"]`).forEach(d=>{d.classList.add(n)});else for(let g=0;g<l;g+=1)t.slides[e.realIndex+g]&&t.slides[e.realIndex+g].classList.add(n);const w=e.params.thumbs.autoScrollOffset,E=w&&!t.params.loop;if(e.realIndex!==t.realIndex||E){const g=t.activeIndex;let d,P;if(t.params.loop){const a=t.slides.filter(L=>L.getAttribute("data-swiper-slide-index")===`${e.realIndex}`)[0];d=t.slides.indexOf(a),P=e.activeIndex>e.previousIndex?"next":"prev"}else d=e.realIndex,P=d>e.previousIndex?"next":"prev";E&&(d+=P==="next"?w:-1*w),t.visibleSlidesIndexes&&t.visibleSlidesIndexes.indexOf(d)<0&&(t.params.centeredSlides?d>g?d=d-Math.floor(m/2)+1:d=d+Math.floor(m/2)-1:d>g&&t.params.slidesPerGroup,t.slideTo(d,s?0:void 0))}}c("beforeInit",()=>{const{thumbs:s}=e.params;if(!(!s||!s.swiper))if(typeof s.swiper=="string"||s.swiper instanceof HTMLElement){const t=X(),m=()=>{const n=typeof s.swiper=="string"?t.querySelector(s.swiper):s.swiper;if(n&&n.swiper)s.swiper=n.swiper,T(),u(!0);else if(n){const w=E=>{s.swiper=E.detail[0],n.removeEventListener("init",w),T(),u(!0),s.swiper.update(),e.update()};n.addEventListener("init",w)}return n},l=()=>{if(e.destroyed)return;m()||requestAnimationFrame(l)};requestAnimationFrame(l)}else T(),u(!0)}),c("slideChange update resize observerUpdate",()=>{u()}),c("setTransition",(s,t)=>{const m=e.thumbs.swiper;!m||m.destroyed||m.setTransition(t)}),c("beforeDestroy",()=>{const s=e.thumbs.swiper;!s||s.destroyed||f&&s.destroy()}),Object.assign(e.thumbs,{init:T,update:u})}function ie(i){let{swiper:e,extendParams:h,emit:c,once:r}=i;h({freeMode:{enabled:!1,momentum:!0,momentumRatio:1,momentumBounce:!0,momentumBounceRatio:1,momentumVelocityRatio:1,sticky:!1,minimumVelocity:.02}});function f(){if(e.params.cssMode)return;const u=e.getTranslate();e.setTranslate(u),e.setTransition(0),e.touchEventsData.velocities.length=0,e.freeMode.onTouchEnd({currentPos:e.rtl?e.translate:-e.translate})}function k(){if(e.params.cssMode)return;const{touchEventsData:u,touches:s}=e;u.velocities.length===0&&u.velocities.push({position:s[e.isHorizontal()?"startX":"startY"],time:u.touchStartTime}),u.velocities.push({position:s[e.isHorizontal()?"currentX":"currentY"],time:F()})}function T(u){let{currentPos:s}=u;if(e.params.cssMode)return;const{params:t,wrapperEl:m,rtlTranslate:l,snapGrid:n,touchEventsData:w}=e,g=F()-w.touchStartTime;if(s<-e.minTranslate()){e.slideTo(e.activeIndex);return}if(s>-e.maxTranslate()){e.slides.length<n.length?e.slideTo(n.length-1):e.slideTo(e.slides.length-1);return}if(t.freeMode.momentum){if(w.velocities.length>1){const v=w.velocities.pop(),y=w.velocities.pop(),G=v.position-y.position,U=v.time-y.time;e.velocity=G/U,e.velocity/=2,Math.abs(e.velocity)<t.freeMode.minimumVelocity&&(e.velocity=0),(U>150||F()-v.time>300)&&(e.velocity=0)}else e.velocity=0;e.velocity*=t.freeMode.momentumVelocityRatio,w.velocities.length=0;let d=1e3*t.freeMode.momentumRatio;const P=e.velocity*d;let a=e.translate+P;l&&(a=-a);let L=!1,D;const O=Math.abs(e.velocity)*20*t.freeMode.momentumBounceRatio;let V;if(a<e.maxTranslate())t.freeMode.momentumBounce?(a+e.maxTranslate()<-O&&(a=e.maxTranslate()-O),D=e.maxTranslate(),L=!0,w.allowMomentumBounce=!0):a=e.maxTranslate(),t.loop&&t.centeredSlides&&(V=!0);else if(a>e.minTranslate())t.freeMode.momentumBounce?(a-e.minTranslate()>O&&(a=e.minTranslate()+O),D=e.minTranslate(),L=!0,w.allowMomentumBounce=!0):a=e.minTranslate(),t.loop&&t.centeredSlides&&(V=!0);else if(t.freeMode.sticky){let v;for(let y=0;y<n.length;y+=1)if(n[y]>-a){v=y;break}Math.abs(n[v]-a)<Math.abs(n[v-1]-a)||e.swipeDirection==="next"?a=n[v]:a=n[v-1],a=-a}if(V&&r("transitionEnd",()=>{e.loopFix()}),e.velocity!==0){if(l?d=Math.abs((-a-e.translate)/e.velocity):d=Math.abs((a-e.translate)/e.velocity),t.freeMode.sticky){const v=Math.abs((l?-a:a)-e.translate),y=e.slidesSizesGrid[e.activeIndex];v<y?d=t.speed:v<2*y?d=t.speed*1.5:d=t.speed*2.5}}else if(t.freeMode.sticky){e.slideToClosest();return}t.freeMode.momentumBounce&&L?(e.updateProgress(D),e.setTransition(d),e.setTranslate(a),e.transitionStart(!0,e.swipeDirection),e.animating=!0,j(m,()=>{!e||e.destroyed||!w.allowMomentumBounce||(c("momentumBounce"),e.setTransition(t.speed),setTimeout(()=>{e.setTranslate(D),j(m,()=>{!e||e.destroyed||e.transitionEnd()})},0))})):e.velocity?(c("_freeModeNoMomentumRelease"),e.updateProgress(a),e.setTransition(d),e.setTranslate(a),e.transitionStart(!0,e.swipeDirection),e.animating||(e.animating=!0,j(m,()=>{!e||e.destroyed||e.transitionEnd()}))):e.updateProgress(a),e.updateActiveIndex(),e.updateSlidesClasses()}else if(t.freeMode.sticky){e.slideToClosest();return}else t.freeMode&&c("_freeModeNoMomentumRelease");(!t.freeMode.momentum||g>=t.longSwipesMs)&&(e.updateProgress(),e.updateActiveIndex(),e.updateSlidesClasses())}Object.assign(e,{freeMode:{onTouchStart:f,onTouchMove:k,onTouchEnd:T}})}const re="https://two024-south-json-server-vercel.onrender.com",oe={components:{Swiper:K,SwiperSlide:Q},data(){return{attractionTitle:"",attractions:[],enabledAttractions:[],imagesUrl:""}},methods:{getAttractions(){this.axios.get(`${re}/attractions`).then(i=>{this.attractions=i.data,this.attractions.forEach(e=>{e.is_enabled===1&&this.attractionTitle===e.title&&this.enabledAttractions.push(e)}),this.imagesUrl=this.enabledAttractions[0].imagesUrl}).catch(i=>{_.threeLayerCheckType("error","取得景點資料失敗")})}},setup(){const i=Z(null);return{thumbsSwiper:i,setThumbsSwiper:h=>{i.value=h},modules:[ie,W,se]}},mounted(){this.attractionTitle=this.$route.params.title,this.getAttractions()}},ne=["src"],ae=["src"];function le(i,e,h,c,r,f){const k=I("swiper-slide"),T=I("swiper");return p(),b(x,null,[S(T,{spaceBetween:10,navigation:!0,thumbs:{swiper:c.thumbsSwiper},modules:c.modules,class:"mySwiper2"},{default:C(()=>[(p(!0),b(x,null,M(r.imagesUrl,(u,s)=>(p(),H(k,{key:s+123},{default:C(()=>[o("img",{src:u,class:"img-fluid"},null,8,ne)]),_:2},1024))),128))]),_:1},8,["thumbs","modules"]),S(T,{onSwiper:c.setThumbsSwiper,spaceBetween:10,slidesPerView:4,freeMode:!0,watchSlidesProgress:!0,modules:c.modules,class:"mySwiper3"},{default:C(()=>[(p(!0),b(x,null,M(r.imagesUrl,(u,s)=>(p(),H(k,{key:s+123},{default:C(()=>[o("img",{src:u,class:"img-fluid"},null,8,ae)]),_:2},1024))),128))]),_:1},8,["onSwiper","modules"])],64)}const ce=q(oe,[["render",le]]),B="https://two024-south-json-server-vercel.onrender.com",de={components:{singleAttraction:ce,BannerBlock:te},data(){return{category:"",attractionTitle:"",attractions:[],enabledAttractions:[],newAttractionsContent:"",newAttractionsTimeOpen:"",attractionId:"",heartData:[],isFavorite:{},userId:"",token:"",isLoading:!1}},methods:{redirectToA(i){this.$router.push({path:"/TouristAttractions",query:{category:i}})},getHeartData(){this.axios.get(`${B}/hearts`).then(i=>{i.data.forEach(e=>{e.userId===this.userId&&e.tag==="旅遊景點"&&(this.isFavorite[e.product]=!0)})}).catch(i=>{_.threeLayerCheckType("error","取得愛心收藏資料失敗")})},toggleFavorite(i,e,h){this.token?this.axios.get(`${B}/hearts`).then(c=>{const r=c.data.find(f=>f.product===i&&f.userId===this.userId&&f.tag==="旅遊景點");r?this.axios.delete(`${B}/hearts/${r.id}`).then(f=>{this.isFavorite[i]=!1,_.threeLayerCheckType("success",`取消收藏 ${h} 成功`),this.getHeartData()}).catch(f=>{_.threeLayerCheckType("error","取消收藏資料失敗")}):this.axios.post(`${B}/hearts`,{product:i,category:e,title:h,userId:this.userId,tag:"旅遊景點"}).then(f=>{this.isFavorite[i]=!0,_.threeLayerCheckType("success",`已加入收藏 ${h} 成功`),this.getHeartData()}).catch(f=>{_.threeLayerCheckType("error","收藏資料失敗")})}).catch(c=>{_.threeLayerCheckType("error","取得愛心收藏資料失敗")}):_.threeLayerCheckType("warning","請登入會員後，才能加入收藏")},getAttractions(){this.axios.get(`${B}/attractions`).then(i=>{this.attractions=i.data,this.attractions.forEach(e=>{e.is_enabled===1&&this.attractionTitle===e.title&&(this.enabledAttractions.push(e),this.attractionId=e.id,this.isLoading=!1)}),this.getNewText(),this.getnewAttractionsTimeOpen()}).catch(()=>{_.threeLayerCheckType("error","取得景點資料失敗")})},getNewText(){const i={};this.attractions.forEach(e=>{e.content&&e.content.split(";").forEach(c=>{const r=c.trim();i[e.id]||(i[e.id]=[]),i[e.id].push(r)})}),this.newProductsContent=Object.entries(i).map(([e,h])=>({id:e,content:h}))},getnewAttractionsTimeOpen(){const i={};this.attractions.forEach(e=>{e.content&&e.timeOpen.split(";").forEach(c=>{const r=c.trim();i[e.id]||(i[e.id]=[]),i[e.id].push(r)})}),this.newAttractionsTimeOpen=Object.entries(i).map(([e,h])=>({id:e,content:h}))},getCookie(i){const e=document.cookie.split(";");for(let h of e){const[c,r]=h.trim().split("=");if(c===i)return r}return null}},mounted(){this.category=this.$route.params.category,this.attractionTitle=this.$route.params.title;const i=this.getCookie("userId"),e=this.getCookie("hexTokenU");this.userId=i*1,this.token=e,this.isLoading=!0,this.getAttractions(),this.getHeartData(),window.scrollTo(0,0)}},ue={class:"container py-10 py-lg-30 px-lg-20"},me={style:{"--bs-breadcrumb-divider":"'>'"},"aria-label":"breadcrumb",class:"pb-5 pb-lg-15"},he={class:"breadcrumb mb-0 fs-5"},pe={class:"breadcrumb-item"},fe={class:"breadcrumb-item"},be={class:"breadcrumb-item"},we={class:"breadcrumb-item"},ge={class:"intr-title d-flex align-items-center mb-4 fs-3 border-start border-primary-500 border-3"},ve={class:"fs-3 me-2 fw-bold ps-3"},Te={class:"fs-3 me-4 fw-bold"},ye={key:0},_e={class:"tourist-intr-content my-lg-10 my-5"},xe={class:"mb-8"},ke=o("p",{class:"fs-5 fs-md-4 fw-bold mb-4"},"景點介紹",-1),Se={class:"fs-6 fs-md-5"},Me={class:"mb-8"},Ae=o("span",{class:"fs-5 fs-md-4 mb-4 fw-bold"},"開放時間：",-1),Ce={key:0},Ie=o("p",{class:"fs-5 fs-md-4 mb-3 fw-bold"},"交通資訊：",-1),Ee={class:"row"},Pe={class:"d-flex col-12 col-lg-7 justify-content-between flex-column"},Le={key:0},Be={class:"col-12 col-lg-5"},De=["src"];function Oe(i,e,h,c,r,f){const k=I("VueLoading"),T=I("BannerBlock"),u=I("router-link"),s=I("singleAttraction");return p(),b(x,null,[S(k,{active:r.isLoading,class:"text-center","z-index":1060},null,8,["active"]),S(T),o("div",ue,[o("nav",me,[o("ol",he,[o("li",pe,[S(u,{to:"/",exact:"","active-class":"active-link"},{default:C(()=>[$("首頁")]),_:1})]),o("li",fe,[S(u,{exact:"","active-class":"active-link",to:{path:"/TouristAttractions",query:{category:"全部",page:"1"}}},{default:C(()=>[$(" 南部旅遊景點 ")]),_:1})]),o("li",be,[N(o("a",{onClick:e[0]||(e[0]=t=>f.redirectToA("台南")),class:"navbar-brand"},"台南",512),[[z,r.category==="台南"]]),N(o("a",{onClick:e[1]||(e[1]=t=>f.redirectToA("嘉義")),class:"navbar-brand"},"嘉義",512),[[z,r.category==="嘉義"]]),N(o("a",{onClick:e[2]||(e[2]=t=>f.redirectToA("高雄")),class:"navbar-brand"},"高雄",512),[[z,r.category==="高雄"]])]),o("li",we,A(r.attractionTitle),1)])]),o("div",ge,[o("span",ve,A(r.category),1),o("p",Te,A(r.attractionTitle),1),o("button",{class:"border-0 heart4 fs-3",onClick:e[3]||(e[3]=t=>f.toggleFavorite(r.attractionId,r.category,r.attractionTitle)),type:"button"},[o("i",{class:ee(["bi",{"bi-heart-fill":r.isFavorite[r.attractionId],"bi-heart":!r.isFavorite[r.attractionId]}])},null,2)])]),S(s),(p(!0),b(x,null,M(r.enabledAttractions,(t,m)=>(p(),b("div",{class:"row g-3",key:t.id},[m===0?(p(),b("div",ye,[o("div",_e,[o("div",xe,[ke,o("p",Se,A(t.description),1)]),o("div",Me,[Ae,(p(!0),b(x,null,M(r.newAttractionsTimeOpen,l=>(p(),b("div",{key:l.id},[l.id===t.id?(p(),b("div",Ce,[(p(!0),b(x,null,M(l.content,n=>(p(),b("p",{key:n+123,class:"fs-6 fs-md-5 my-4"},A(n),1))),128))])):R("",!0)]))),128))]),o("div",null,[Ie,o("div",Ee,[o("div",Pe,[(p(!0),b(x,null,M(i.newProductsContent,l=>(p(),b("div",{key:l.id},[l.id===t.id?(p(),b("div",Le,[(p(!0),b(x,null,M(l.content,n=>(p(),b("p",{key:n,class:"fs-6 fs-md-5 my-4 mb-4"},A(n),1))),128))])):R("",!0)]))),128))]),o("div",Be,[o("iframe",{src:t.imgMap,width:"100%",height:"100%",style:{border:"0"},allowfullscreen:"",loading:"lazy",referrerpolicy:"no-referrer-when-downgrade"},null,8,De)])])])])])):R("",!0)]))),128))])],64)}const ze=q(de,[["render",Oe]]);export{ze as default};
