import{s as l}from"./sweetAlert-puKBlb7F.js";import{_ as g,c as C,a as o,b as i,w as v,r as d,o as b,n as h,p as y,f as V}from"./index-bTnw3Wno.js";const _="https://two024-south-json-server-vercel.onrender.com",k={data(){return{user:{email:"",password:""},userCarts:[],cartsLength:0}},methods:{async login(){event.preventDefault();try{const e=await this.axios.post(`${_}/login`,this.user),{accessToken:t,expired:a}=e.data,r=e.data.user.id;document.cookie=`hexTokenU=${t}; expires=${new Date(a).toUTCString()}`,document.cookie=`userId=${r}`,this.userIsLoggedIn2=!0,l.threeLayerCheckType("success","會員登入成功"),this.$emitter.emit("loginCheck2",!0),this.$router.push("/"),r&&(await this.getCarts(r),this.$emitter.emit("adminUpdateCart",this.cartsLength))}catch(e){console.error(e),l.threeLayerCheckType("error","會員登入失敗，請再次填寫會員登入資料")}},getCarts(e){return this.axios.get(`${_}/carts`).then(t=>{this.userCarts=t.data.filter(s=>s.userId===e);const a=[],r=new Set;this.userCarts.forEach(s=>{r.has(s.productId)||(r.add(s.productId),a.push(s))}),this.userCarts=a,this.cartsLength=this.userCarts.length}).catch(t=>{l.threeLayerCheckType("error","取得購物車資料失敗")})}},mounted(){window.scrollTo(0,0)}},n=e=>(y("data-v-73587671"),e=e(),V(),e),I={class:"container py-10 py-lg-30"},x={class:"row justify-content-center align-items-cneter"},L={class:"col-md-6"},S=n(()=>o("h1",{class:"h3 mb-4 text-center"},"會員登入",-1)),T={class:"form-floating mb-4"},$=n(()=>o("label",{for:"email"},"請輸入 Email",-1)),E={class:"form-floating mb-4"},U=n(()=>o("label",{for:"userpassword"},"請輸入Password",-1)),q=n(()=>o("button",{class:"btn-turquoise w-100 mt-4 btn-rounded",type:"submit",id:"login"}," 登入 ",-1));function F(e,t,a,r,s,f){const u=d("VeeField"),m=d("ErrorMessage"),w=d("VeeForm");return b(),C("div",I,[o("div",x,[o("div",L,[S,i(w,{id:"form",ref:"form",onSubmit:f.login},{default:v(({errors:p})=>[o("div",T,[i(u,{type:"email",name:"email",class:h(["form-control",{"is-invalid":p.email}]),modelValue:s.user.email,"onUpdate:modelValue":t[0]||(t[0]=c=>s.user.email=c),id:"email",placeholder:"請輸入 Email",rules:"email|required",autocomplete:"useremail"},null,8,["modelValue","class"]),$,i(m,{name:"email",class:"invalid-feedback"})]),o("div",E,[i(u,{type:"password",class:h(["form-control",{"is-invalid":p.password}]),name:"password",id:"userpassword",placeholder:"請輸入Password",rules:"min:8|alpha_dash|required",autocomplete:"current-password",modelValue:s.user.password,"onUpdate:modelValue":t[1]||(t[1]=c=>s.user.password=c)},null,8,["class","modelValue"]),U,i(m,{name:"password",class:"invalid-feedback"})]),q]),_:1},8,["onSubmit"])])])])}const D=g(k,[["render",F],["__scopeId","data-v-73587671"]]);export{D as default};
