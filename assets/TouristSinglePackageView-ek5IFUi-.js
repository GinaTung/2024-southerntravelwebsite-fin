import{_ as C,c as d,a as t,b as g,w as f,g as u,j as m,t as l,F as y,h as v,r as D,o as n,d as o,f as T,i as P,n as w}from"./index-OzyLONWC.js";const p="https://two024-south-json-server-vercel.onrender.com",q={data(){return{category:"",packageTitle:"",products:[],newProductsContent:"",enabledProducts:[],carts:[],quantity:1,newQty:0,newCarts:[],cartId:null,bsOffcanvas:null,userId:"",token:"",currentDate:"",endDate:"",isDisabled:!1}},created(){this.category=this.$route.params.category,this.packageTitle=this.$route.params.title},methods:{checkDate(){var a=new Date,s={year:a.getFullYear(),month:a.getMonth()+1,date:a.getDate()},r=(s.month<10?"0":"")+s.month,c=(s.date<10?"0":"")+s.date,i=s.year+"-"+r+"-"+c;this.currentDate=i},getProducts(){this.axios.get(`${p}/products`).then(a=>{this.products=a.data,this.products.forEach(s=>{s.is_enabled===1&&s.title===this.packageTitle&&this.enabledProducts.push(s)}),this.endDate=this.enabledProducts[0].endDate,this.getNewText()}).catch(a=>{alert(`${a.message}`)})},thousand(a){return a!==void 0&&(a=a.toString().replace(new RegExp("\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))","g"),",")),`$ ${a}`},getNewText(){const a={};this.enabledProducts.forEach(s=>{s.content&&s.content.split(";").forEach(c=>{const i=c.trim();i!==""&&(a[s.id]||(a[s.id]=[]),a[s.id].push(i))})});for(const s in a)a[s].length===0&&delete a[s];this.newProductsContent=Object.entries(a).map(([s,r])=>({id:s,content:r}))},addToCart(a,s=1,r){if(!this.token)alert("請登入會員後，才能預約套裝行程");else{let c=!1;this.newCarts.forEach(i=>{i.productId===a&&i.id&&(c=!0,this.cartId=i.id)}),c?this.axios.put(`${p}/carts/${this.cartId}`,{productId:a,qty:s,price:r,total:s*r,userId:this.userId}).then(i=>{alert("已更新預約人數"),this.getCart()}).catch(i=>{alert("更新預約人數失敗")}):this.axios.post(`${p}/carts`,{productId:a,qty:s,price:r,total:s*r,userId:this.userId}).then(i=>{alert(`已預約${this.packageTitle}成功`),this.getCart()}).catch(i=>{alert("預約失敗，再重新登入預約")})}},incrementQuantity(){this.quantity<10&&(this.quantity+=1)},decrementQuantity(){this.quantity>1&&(this.quantity-=1)},checkMaxValue(){this.quantity>10&&(this.quantity=10)},handlePlus(a){this.quantity=a++},saveCardId(){document.cookie=`cartId=${this.newCarts.id}; path=/;`},getCart(){this.axios.get(`${p}/carts`).then(a=>{this.carts=a.data,this.carts.forEach(s=>{s.userId===this.userId&&this.newCarts.push(s)})}).catch(a=>{alert("取得購物車資料失敗")})},getCookie(a){const s=document.cookie.split(";");for(let r of s){const[c,i]=r.trim().split("=");if(c===a)return i}return null}},mounted(){this.getProducts(),this.getCart();const a=this.getCookie("userId"),s=this.getCookie("hexTokenU");this.userId=a*1,this.token=s,this.checkDate()}},U={class:"container py-10 py-lg-30"},E={style:{"--bs-breadcrumb-divider":"'>'"},"aria-label":"breadcrumb",class:"pb-5 pb-lg-15"},N={class:"breadcrumb mb-0 fs-5"},Q={class:"breadcrumb-item"},V={class:"breadcrumb-item"},S={class:"breadcrumb-item"},j={class:"breadcrumb-item"},B={class:"col-12 col-md-7 col-lg-9 my-8 my-md-0"},M={class:"d-flex"},F=t("div",{class:"w-5 d-none d-xl-flex"},[t("i",{class:"bi bi-geo-alt-fill position-relative fs-5"},[t("div",{class:"line"}),t("i",{class:"bi bi-arrow-down-circle-fill arrow"})])],-1),O={class:"w-100 w-xl-95 position-relative pe-0 pe-lg-5"},z=t("h4",{class:"d-flex"},[t("i",{class:"bi bi-geo-fill d-flex d-xl-none me-2 align-items-end"}),o("第一天 ")],-1),K=t("ul",{class:"nav nav-underline nav-fill mb-4 w-100 w-lg-60",id:"pills-tab",role:"tablist"},[t("li",{class:"nav-item",role:"presentation"},[t("button",{class:"nav-link",id:"pills-home-tab","data-bs-toggle":"pill","data-bs-target":"#pills-home",type:"button",role:"tab","aria-controls":"pills-home","aria-selected":"true"}," 早上 ")]),t("li",{class:"nav-item",role:"presentation"},[t("button",{class:"nav-link",id:"pills-profile-tab","data-bs-toggle":"pill","data-bs-target":"#pills-profile",type:"button",role:"tab","aria-controls":"pills-profile","aria-selected":"false"}," 下午 ")])],-1),L={class:"tab-content card-att",id:"pills-tabContent"},Y={class:"tab-pane fade show active",id:"pills-home",role:"tabpanel","aria-labelledby":"pills-home-tab",tabindex:"0"},A={class:"row"},G={class:"w-100 w-lg-60 mb-4"},H={class:"card-att-img card-att-img-2"},J=["src","alt"],R={class:"w-100 w-lg-40"},W={class:"fs-5 fs-xl-4 fw-bold text-primary-700 card-title-att mb-4"},X={class:"text-dark mb-4"},Z={class:"tab-pane fade",id:"pills-profile",role:"tabpanel","aria-labelledby":"pills-profile-tab",tabindex:"0"},$={class:"row"},I={class:"w-100 w-lg-60 mb-4"},tt={class:"card-att-img card-att-img-2"},st=["src","alt"],et={class:"w-100 w-lg-40"},at={class:"fs-5 fs-xl-4 fw-bold text-primary-700 card-title-att mb-4"},it={class:"text-dark"},lt={key:0},ot={class:"d-flex my-12"},nt=t("div",{class:"w-5 d-none d-xl-flex"},[t("i",{class:"bi bi-geo-alt-fill position-relative fs-5"},[t("div",{class:"line"}),t("i",{class:"bi bi-arrow-down-circle-fill arrow"})])],-1),rt={class:"w-100 w-xl-95 position-relative pe-0 pe-lg-5"},dt=t("h4",{class:"d-flex"},[t("i",{class:"bi bi-geo-fill d-flex d-xl-none me-2 align-items-end"}),o("第二天 ")],-1),ct=t("ul",{class:"nav nav-underline nav-fill mb-4 w-100 w-lg-60",id:"pills-tab",role:"tablist"},[t("li",{class:"nav-item",role:"presentation"},[t("button",{class:"nav-link",id:"pills-home-tab","data-bs-toggle":"pill","data-bs-target":"#pills-home2",type:"button",role:"tab","aria-controls":"pills-home","aria-selected":"true"}," 早上 ")]),t("li",{class:"nav-item",role:"presentation"},[t("button",{class:"nav-link",id:"pills-profile-tab","data-bs-toggle":"pill","data-bs-target":"#pills-profile2",type:"button",role:"tab","aria-controls":"pills-profile","aria-selected":"false"}," 下午 ")])],-1),_t={class:"tab-content card-att",id:"pills-tabContent"},bt={class:"tab-pane fade show active",id:"pills-home2",role:"tabpanel","aria-labelledby":"pills-home-tab",tabindex:"0"},ht={class:"row"},ft={class:"w-100 w-lg-60 mb-4"},mt={class:"card-att-img card-att-img-2"},pt=["src","alt"],gt={class:"w-100 w-lg-40"},ut={class:"fs-5 fs-xl-4 fw-bold text-primary-700 card-title-att mb-4"},yt={class:"text-dark mb-4"},vt={class:"tab-pane fade",id:"pills-profile2",role:"tabpanel","aria-labelledby":"pills-profile-tab",tabindex:"0"},xt={class:"row"},wt={class:"w-100 w-lg-60 mb-4"},kt={class:"card-att-img card-att-img-2"},Ct=["src","alt"],Dt={class:"w-lg-40"},Tt={class:"fs-5 fs-xl-4 fw-bold text-primary-700 card-title-att mb-4"},Pt={class:"text-dark"},qt={key:1},Ut={class:"d-flex my-12"},Et=t("div",{class:"w-5 d-none d-xl-flex"},[t("i",{class:"bi bi-geo-alt-fill position-relative fs-5"},[t("div",{class:"line"}),t("i",{class:"bi bi-arrow-down-circle-fill arrow"})])],-1),Nt={class:"w-100 w-xl-95 position-relative pe-0 pe-lg-5"},Qt=t("h4",{class:"d-flex"},[t("i",{class:"bi bi-geo-fill d-flex d-xl-none me-2 align-items-end"}),o("第三天 ")],-1),Vt=t("ul",{class:"nav nav-underline nav-fill mb-4 w-100 w-lg-60",id:"pills-tab",role:"tablist"},[t("li",{class:"nav-item",role:"presentation"},[t("button",{class:"nav-link",id:"pills-home-tab","data-bs-toggle":"pill","data-bs-target":"#pills-home2",type:"button",role:"tab","aria-controls":"pills-home","aria-selected":"true"}," 早上 ")]),t("li",{class:"nav-item",role:"presentation"},[t("button",{class:"nav-link",id:"pills-profile-tab","data-bs-toggle":"pill","data-bs-target":"#pills-profile2",type:"button",role:"tab","aria-controls":"pills-profile","aria-selected":"false"}," 下午 ")])],-1),St={class:"tab-content card-att",id:"pills-tabContent"},jt={class:"tab-pane fade show active",id:"pills-home2",role:"tabpanel","aria-labelledby":"pills-home-tab",tabindex:"0"},Bt={class:"row"},Mt={class:"w-100 w-lg-60 mb-4"},Ft={class:"card-att-img card-att-img-2"},Ot=["src","alt"],zt={class:"w-100 w-lg-40"},Kt={class:"fs-5 fs-xl-4 fw-bold text-primary-700 card-title-att mb-4"},Lt={class:"text-dark mb-4"},Yt={class:"tab-pane fade",id:"pills-profile2",role:"tabpanel","aria-labelledby":"pills-profile-tab",tabindex:"0"},At={class:"row"},Gt={class:"w-100 w-lg-60 mb-4"},Ht={class:"card-att-img card-att-img-2"},Jt=["src","alt"],Rt={class:"w-lg-40"},Wt={class:"fs-5 fs-xl-4 fw-bold text-primary-700 card-title-att mb-4"},Xt={class:"text-dark"},Zt={class:"col-12 col-md-5 col-lg-3"},$t={class:"d-flex mb-4"},It={class:"badge rounded-pill bg-primary-200 text-primary-600 fw-bold me-1 py-1 px-4 fs-6"},ts={class:"fs-3 fs-sm-4 fs-xl-3 mb-6 text-primary-700 fw-bold"},ss=t("span",{class:"fs-4 fs-sm-5 fs-xl-4 mb-2 border-bottom border-primary-400 border-3 text-primary-600"},[t("i",{class:"bi bi-person-walking me-2"}),o("景點行程 ")],-1),es={class:"mt-2 mb-6"},as={class:"d-flex mb-4 flex-column mb-6"},is=t("h5",{class:"mb-2"},[t("span",{class:"fs-4 fs-sm-5 fs-xl-4 mb-2 border-bottom border-primary-400 border-3 text-primary-600"},[t("i",{class:"bi bi-calendar-plus me-2"}),o("預約期間 ")])],-1),ls={key:0,class:"mt-2"},os={key:1,class:"mt-2 text-danger"},ns={class:"d-flex mb-4 flex-column"},rs=t("h5",{class:"mb-2"},[t("span",{class:"fs-4 fs-sm-5 fs-xl-4 mb-2 border-bottom border-primary-400 border-3 text-primary-600"},[t("i",{class:"bi bi-car-front-fill me-2"}),o("出發時間 ")])],-1),ds={class:"mt-2"},cs={class:"d-flex justify-content-between mb-4 align-items-end"},_s={class:"fs-4 fs-lg-5 text-decoration-line-through text-end"},bs={class:"d-flex flex-sm-column align-items-end justify-content-end"},hs=t("p",{class:"fs-6 text-danger fw-bold d-none d-sm-block"},"促銷價",-1),fs={class:"fs-2 fs-sm-3 fs-lg-4 fs-xl-2 text-danger"},ms={class:"d-flex mb-2"},ps=["disabled"],gs=t("i",{class:"bi bi-dash-lg"},null,-1),us=[gs],ys=["disabled"],vs=t("i",{class:"bi bi-plus-lg"},null,-1),xs=[vs],ws=t("button",{type:"button",class:"btn btn-outline-dark rounded-0 ms-2"},[t("i",{class:"bi bi-heart"})],-1),ks=t("h6",{class:"mb-2"},[o(" 注意： "),t("span",{class:"text-danger"}," 至少3位成團，最多10位出遊 ")],-1),Cs={key:0,class:"mb-5"},Ds=t("span",{class:"text-danger"},"0",-1),Ts=t("span",{class:"text-danger"},"10",-1),Ps=["onClick"];function qs(a,s,r,c,i,_){const h=D("router-link");return n(),d("div",U,[t("nav",E,[t("ol",N,[t("li",Q,[g(h,{to:"/",exact:"","active-class":"active-link"},{default:f(()=>[o(" 首頁 ")]),_:1})]),t("li",V,[g(h,{to:"/TouristPackage",exact:"","active-class":"active-link"},{default:f(()=>[o(" 南部旅遊方案 ")]),_:1})]),t("li",S,[i.category==="台南"?(n(),u(h,{key:0,to:"/TouristPackage/searchTainan",exact:"","active-class":"active-link"},{default:f(()=>[o("台南")]),_:1})):i.category==="嘉義"?(n(),u(h,{key:1,to:"/TouristPackage/searchChiayi",exact:"","active-class":"active-link"},{default:f(()=>[o("嘉義")]),_:1})):i.category==="高雄"?(n(),u(h,{key:2,to:"/TouristPackage/searchKaohsiung",exact:"","active-class":"active-link"},{default:f(()=>[o("高雄")]),_:1})):m("",!0)]),t("li",j,l(i.packageTitle),1)])]),(n(!0),d(y,null,v(i.enabledProducts,e=>(n(),d("div",{class:"row h-100 flex-wrap-reverse flex-md-nowrap",key:e.id},[t("div",B,[t("div",M,[F,t("div",O,[z,K,t("div",L,[t("div",Y,[t("div",A,[t("div",G,[t("div",H,[t("img",{src:e.imagesUrl[0],class:"img-fluid pb-4 pb-lg-0",alt:e.title},null,8,J)])]),t("div",R,[t("h4",W,l(e.itinerary_data[0].itinerary_first_day_am_title),1),t("p",X,l(e.itinerary_data[0].itinerary_first_day_am_content),1)])])]),t("div",Z,[t("div",$,[t("div",I,[t("div",tt,[t("img",{src:e.imagesUrl[1],class:"img-fluid pb-4 pb-lg-0",alt:e.title},null,8,st)])]),t("div",et,[t("h4",at,l(e.itinerary_data[0].itinerary_first_day_pm_title),1),t("p",it,l(e.itinerary_data[0].itinerary_first_day_pm_content),1)])])])])])]),e.itinerary_data.length>1?(n(),d("div",lt,[t("div",ot,[nt,t("div",rt,[dt,ct,t("div",_t,[t("div",bt,[t("div",ht,[t("div",ft,[t("div",mt,[t("img",{src:e.imagesUrl[2],class:"img-fluid pb-4 pb-lg-0",alt:e.title},null,8,pt)])]),t("div",gt,[t("h4",ut,l(e.itinerary_data[1].itinerary_second_day_am_title),1),t("p",yt,l(e.itinerary_data[1].itinerary_second_day_am_content),1)])])]),t("div",vt,[t("div",xt,[t("div",wt,[t("div",kt,[t("img",{src:e.imagesUrl[3],class:"img-fluid pb-4 pb-lg-0",alt:e.title},null,8,Ct)])]),t("div",Dt,[t("h4",Tt,l(e.itinerary_data[1].itinerary_second_day_pm_title),1),t("p",Pt,l(e.itinerary_data[1].itinerary_second_day_pm_content),1)])])])])])])])):m("",!0),e.itinerary_data.length>2?(n(),d("div",qt,[t("div",Ut,[Et,t("div",Nt,[Qt,Vt,t("div",St,[t("div",jt,[t("div",Bt,[t("div",Mt,[t("div",Ft,[t("img",{src:e.imagesUrl[4],class:"img-fluid pb-4 pb-lg-0",alt:e.title},null,8,Ot)])]),t("div",zt,[t("h4",Kt,l(e.itinerary_data[2].itinerary_third_day_am_title),1),t("p",Lt,l(e.itinerary_data[2].itinerary_third_day_am_content),1)])])]),t("div",Yt,[t("div",At,[t("div",Gt,[t("div",Ht,[t("img",{src:e.imagesUrl[5],class:"img-fluid pb-4 pb-lg-0",alt:e.title},null,8,Jt)])]),t("div",Rt,[t("h4",Wt,l(e.itinerary_data[2].itinerary_third_day_pm_title),1),t("p",Xt,l(e.itinerary_data[2].itinerary_third_day_pm_content),1)])])])])])])])):m("",!0)]),t("div",Zt,[t("div",$t,[t("span",It,l(i.category),1)]),t("h2",ts,l(i.packageTitle),1),ss,t("div",es,[(n(!0),d(y,null,v(i.newProductsContent,(b,k)=>(n(),d("div",{key:k+123},[(n(!0),d(y,null,v(b.content,x=>(n(),d("p",{key:x},l(x),1))),128))]))),128))]),t("div",as,[is,i.currentDate<=e.endDate?(n(),d("h6",ls,l(e.startDate)+" 至 "+l(e.endDate),1)):(n(),d("h5",os,"預約時間已截止"))]),t("div",ns,[rs,t("h6",ds,l(e.goStartDate)+" 至 "+l(e.goEndDate),1)]),t("div",cs,[t("p",_s," NT"+l(_.thousand(e.origin_price)),1),t("div",bs,[hs,t("p",fs," NT"+l(_.thousand(e.price)),1)])]),t("div",ms,[t("button",{class:"btn btn-outline-dark rounded-0",type:"button",disabled:i.quantity===1,onClick:s[0]||(s[0]=(...b)=>_.decrementQuantity&&_.decrementQuantity(...b))},us,8,ps),T(t("input",{min:"1",max:"10",type:"number",disabled:i.quantity>10,class:"form-control text-center rounded-0 border border-dark","onUpdate:modelValue":s[1]||(s[1]=b=>i.quantity=b),readonly:""},null,8,ys),[[P,i.quantity]]),t("button",{class:"btn btn-outline-dark rounded-0",type:"button",onClick:s[2]||(s[2]=(...b)=>_.incrementQuantity&&_.incrementQuantity(...b))},xs),ws]),ks,i.currentDate<=e.endDate?(n(),d("h6",Cs,[o(" 目前已有 "),Ds,o(" 位預約，剩 "),Ts,o(" 位可預約 ")])):m("",!0),t("button",{class:w(["btn-square w-100 fs-5 mb-4 border-0",{"disabled-btn":i.currentDate>i.endDate}]),type:"button",onClick:b=>_.addToCart(e.id,i.quantity,e.price)}," 預約套裝行程 ",10,Ps),g(h,{class:w(["btn-square fs-5 w-100",{"disabled-btn":i.currentDate>i.endDate}]),type:"button",to:{name:"checkProduct"},onClick:_.saveCardId},{default:f(()=>[o("直接結帳")]),_:1},8,["class","onClick"])])]))),128))])}const Es=C(q,[["render",qs]]);export{Es as default};
