import{_ as g,c as o,s as d,F as l,o as i,a as e,t as h,u as f}from"./index-Pkf9mfWJ.js";const _="http://localhost:3000",m={data(){return{text:"南部旅遊方案",products:[],user:"",newProductsDes:"",enabledProducts:[],searchChiayi:[],serchTainan:[],searchKaohsiung:[]}},methods:{checkAdmin(){this.token=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*\=\s*([^;]*).*$)|^.*$/,"$1"),this.axios.defaults.headers.common.Authorization=this.token,this.token?(console.log(token,user),this.axios.post(`${_}/api/users/${user}`).then(s=>{this.userIsLoggedIn=!0}).catch(s=>{this.userIsLoggedIn=!1,alert("管理者身分驗證失敗，自動跳轉至登入頁面"),this.$router.push({path:"/admin/adminlogin"})})):(alert("目前未登入管理者身分，請重新登入"),this.$router.push({path:"/admin/adminlogin"}))},getProducts(){this.axios.get(`${_}/products`).then(s=>{console.log(s),this.products=s.data,this.products.forEach(t=>{t.is_enabled===1&&this.enabledProducts.push(t)}),console.log(this.enabledProducts),this.getNewText()}).catch(s=>{console.log(s)})},truncateContent(s,t){return s&&s.length>t?s.substring(0,t)+"...":s},getNewText(){const s={};this.products.forEach(t=>{t.description&&t.description.split(";").forEach(u=>{const r=u.trim();s[t.id]||(s[t.id]=[]),s[t.id].push(r)})}),this.newProductsDes=Object.entries(s).map(([t,c])=>({id:t,descriptions:c})),console.log(this.newProductsDes)}},mounted(){this.getProducts()}},x={class:"row g-0"},k={class:"col-md-4"},b={class:"tag text-white"},w={class:"card-att-img card-att-img-2 h-100"},P=["src","alt"],$=e("div",{class:"heart3"},[e("i",{class:"bi bi-heart heart-click","data-heartStatus":"false"})],-1),v={class:"col-md-8"},y={class:"card-body px-5"},T={class:"fs-5 fs-xl-4 fw-bold text-primary-700 card-title-att mb-4"},D={key:0},A=e("p",{class:"card-text card-text-position"},[e("a",{href:"#",class:"fs-5"},"more")],-1);function E(s,t,c,u,r,N){return i(!0),o(l,null,d(r.enabledProducts,a=>(i(),o("div",{class:"card mb-3 card-att",key:a.id},[e("div",x,[e("div",k,[e("span",b,h(a.category),1),e("div",w,[e("img",{src:a.imageUrl,class:"card-img-top img-fluid",alt:a.title},null,8,P)]),$]),e("div",v,[e("div",y,[e("h4",T,h(a.title),1),(i(!0),o(l,null,d(r.newProductsDes,n=>(i(),o("div",{key:n.id},[n.id===a.id?(i(),o("div",D,[(i(!0),o(l,null,d(n.descriptions,p=>(i(),o("p",{key:p},h(p),1))),128))])):f("",!0)]))),128)),A])])])]))),128)}const C=g(m,[["render",E]]);export{C as default};
