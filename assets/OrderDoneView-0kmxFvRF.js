import{U as C}from"./UserProductModal-LaajBIMH.js";import{C as x}from"./CartNavbar-fDoxZQ70.js";import{C as p}from"./collapse-pLpYAydK.js";import{_ as k,c as l,a as s,b as h,d as n,t as d,f as _,v as b,F as g,h as w,n as y,w as I,r as u,o as a}from"./index-G02QWMa0.js";const f="https://two024-south-json-server-vercel.onrender.com",D={components:{CartNavbar:x,UserProductModal:C},data(){return{userId:"",total:0,cartsData:[],userCart:[],isOpen:!0,isOrderOpen:!0,headerCollapse:{},products:[],product:{},cartTotal:0,orderData:[],userOrder:"",product_id:"",productId:"",productTitle:"",orderId:0}},watch:{$route(){this.headerCollapse.hide(),this.orderCollapse.hide()}},methods:{backPage(){this.$router.go(-1)},toggleOpen(){this.isOpen=!this.isOpen},toggleOpenOrder(){this.isOrderOpen=!this.isOrderOpen},forId(e,t){this.productId=e,this.productTitle=t,this.$refs.userProductModal.openModal()},getOderData(){this.axios.get(`${f}/order`).then(e=>{this.orderData=e.data,this.orderData.forEach(t=>{t.user.userId===this.userId&&t.status===!1&&(this.userOrder=t.user)})}).catch(e=>{console.log(e)})},getCart(){this.axios.get(`${f}/cartsData`).then(e=>{this.cartsData=e.data,this.cartsData.forEach(t=>{t.orderStatus===!1&&t.orderId===this.orderId&&t.data.forEach(i=>{i.userId===this.userId&&this.userCart.push(i)})}),this.userCart.forEach(t=>{this.total+=t.final_total})}).catch(e=>{console.log(e)})},getCookie(e){const i=`; ${document.cookie}`.split(`; ${e}=`);if(i.length===2)return i.pop().split(";").shift()},thousand(e){return e!==void 0&&(e=e.toString().replace(new RegExp("\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))","g"),",")),`$ ${e}`}},mounted(){const e=this.getCookie("userId");this.userId=e*1;const t=this.getCookie("orderId");this.orderId=t*1,this.getOderData(),this.getCart(),this.headerCollapse=new p(this.$refs.headerCollapse,{toggle:!1}),this.orderCollapse=new p(this.$refs.orderCollapse,{toggle:!1})}},E={class:"container py-10 py-lg-30"},M={class:"row"},T={class:"col-md-6 mx-auto pb-5 pb-lg-15"},N=s("div",{class:"text-center mb-10"},[s("div",{class:"text-center"},[s("i",{class:"bi bi-check-circle-fill text-success fs-3"}),s("p",{class:"fs-4"},"感謝您！您的訂單已建立完成")])],-1),P={class:"row"},U={class:"mb-4"},B={class:"d-grid gap-2"},S=s("br",null,null,-1),V={key:0,class:"bi bi-chevron-down"},j={key:1,class:"bi bi-chevron-up"},q={class:"collapse show",id:"collapseExample",ref:"headerCollapse"},F={class:"card card-body rounded-0"},z={class:"col-12 col-md-5 col-lg-4"},L=["src","alt"],A={class:"col-12 col-md-7 col-lg-8 d-flex flex-column justify-content-between"},G={class:"mt-4 mt-md-0 mb-4"},H={class:"mb-4"},J={class:"mb-4"},K={class:"mb-4"},Q=["onClick"],R={class:"mb-4 col-12"},W={class:"d-grid gap-2"},X=s("br",null,null,-1),Y={key:0,class:"bi bi-chevron-down"},Z={key:1,class:"bi bi-chevron-up"},$={class:"collapse show",id:"collapseOrder",ref:"orderCollapse"},ss={class:"card card-body rounded-0",style:{height:"350px"}},es={class:"row p-4 p-md-10"},ts={class:"col-12 col-md-5 col-lg-4"},os={class:"mb-4"},rs={class:"mb-4"},ds={class:"mb-4"},cs={class:"col-12 col-md-7 col-lg-8"},ls={class:"mb-4"},as={class:"mb-4"},is={class:"mb-4"},ns={class:"mb-4"},hs={class:"d-flex justify-content-center"},us={class:"w-100 w-md-25"};function ps(e,t,i,_s,o,c){const m=u("CartNavbar"),O=u("router-link"),v=u("UserProductModal");return a(),l(g,null,[s("div",E,[s("div",M,[s("div",T,[h(m)])]),N,s("div",P,[s("div",U,[s("p",B,[s("button",{class:"btn btn-primary-600 border-top",type:"button","data-bs-toggle":"collapse","data-bs-target":"#collapseExample","aria-expanded":"false","aria-controls":"collapseExample",onClick:t[0]||(t[0]=(...r)=>c.toggleOpen&&c.toggleOpen(...r))},[n(" 總計："+d(c.thousand(o.total))+"元",1),S,n("購買清單 "),o.isOpen===!1?(a(),l("i",V)):(a(),l("i",j))])]),_(s("div",q,[s("div",F,[(a(!0),l(g,null,w(o.userCart,r=>(a(),l("div",{class:"row p-4 p-md-10",key:r.id},[s("div",z,[s("img",{src:r.product.imageUrl,alt:r.product.title,class:"img-fluid h-100"},null,8,L)]),s("div",A,[s("div",null,[s("h4",G,"套裝行程名稱："+d(r.product.title),1),s("h5",H,"單價："+d(c.thousand(r.product.price)),1),s("h5",J,"預約數量："+d(r.qty)+" 位",1),s("h5",K,"總計："+d(c.thousand(r.final_total)),1)]),s("div",null,[s("button",{type:"button",class:"btn-turquoise border-0 rounded-1",onClick:bs=>c.forId(r.product.id,r.product.title)}," 查看更多 ",8,Q)])])]))),128))])],512),[[b,o.isOpen]])]),s("div",R,[s("p",W,[s("button",{class:"btn btn-primary-600 border-top",type:"button","data-bs-toggle":"collapse","data-bs-target":"#collapseOrder","aria-expanded":"true","aria-controls":"collapseOrder",onClick:t[1]||(t[1]=(...r)=>c.toggleOpenOrder&&c.toggleOpenOrder(...r))},[n(" 訂單及運送資料"),X,o.isOrderOpen===!1?(a(),l("i",Y)):(a(),l("i",Z))])]),_(s("div",$,[s("div",ss,[s("div",es,[s("div",ts,[s("h5",os,"收件人名字："+d(o.userOrder.name),1),s("h5",rs,"收件人電話："+d(o.userOrder.tel),1),s("h5",ds,"備註："+d(o.userOrder.comment),1)]),s("div",cs,[s("h5",ls,"收件人地址："+d(o.userOrder.address),1),s("h5",as,"運送方式："+d(o.userOrder.shippingMethod),1),s("h5",is,"付款方式："+d(o.userOrder.payMethod),1),s("h5",ns,[n("付款狀態： "),s("span",{class:y({"text-danger":o.userOrder.status===!1,"text-success":o.userOrder.status===!0})},d(o.userOrder.status?"已付款":"未付款"),3)])])])])],512),[[b,o.isOrderOpen]])])]),s("div",hs,[s("div",us,[h(O,{class:"btn-square mt-4 fs-5 w-100",type:"button",to:"/"},{default:I(()=>[n("回首頁")]),_:1})])])]),h(v,{ref:"userProductModal",userCart:o.userCart,productId:o.productId,productTitle:o.productTitle},null,8,["userCart","productId","productTitle"])],64)}const vs=k(D,[["render",ps]]);export{vs as default};
