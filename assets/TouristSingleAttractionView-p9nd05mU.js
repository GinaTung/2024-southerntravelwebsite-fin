import{g as z,i as q,e as H,S as G,a as J,N as K}from"./navigation-YxrFP0Kr.js";import{f as Q,L as R}from"./LikeBlock-qncxzW8B.js";import{M as W}from"./modal-xDQkZ3LO.js";import{s as v}from"./sweetAlert-nAv4a-BV.js";import{_ as V,l as X,o as l,c as u,b as T,w as S,F as y,h as k,g as F,a as s,r as x,p as D,f as j,j as P,m as E,t as I,n as Y,d as $,k as O}from"./index-GclguVgJ.js";import{B as Z}from"./BannerBlock-Tf6_c7kg.js";import"./selector-engine-FdfFSxLl.js";function ee(t){let{swiper:e,extendParams:d,on:c}=t;d({thumbs:{swiper:null,multipleActiveThumbs:!0,autoScrollOffset:0,slideThumbActiveClass:"swiper-slide-thumb-active",thumbsContainerClass:"swiper-thumbs"}});let o=!1,g=!1;e.thumbs={swiper:null};function p(){const r=e.thumbs.swiper;if(!r||r.destroyed)return;const i=r.clickedIndex,a=r.clickedSlide;if(a&&a.classList.contains(e.params.thumbs.slideThumbActiveClass)||typeof i>"u"||i===null)return;let h;r.params.loop?h=parseInt(r.clickedSlide.getAttribute("data-swiper-slide-index"),10):h=i,e.params.loop?e.slideToLoop(h):e.slideTo(h)}function _(){const{thumbs:r}=e.params;if(o)return!1;o=!0;const i=e.constructor;if(r.swiper instanceof i)e.thumbs.swiper=r.swiper,Object.assign(e.thumbs.swiper.originalParams,{watchSlidesProgress:!0,slideToClickedSlide:!1}),Object.assign(e.thumbs.swiper.params,{watchSlidesProgress:!0,slideToClickedSlide:!1}),e.thumbs.swiper.update();else if(q(r.swiper)){const a=Object.assign({},r.swiper);Object.assign(a,{watchSlidesProgress:!0,slideToClickedSlide:!1}),e.thumbs.swiper=new i(a),g=!0}return e.thumbs.swiper.el.classList.add(e.params.thumbs.thumbsContainerClass),e.thumbs.swiper.on("tap",p),!0}function b(r){const i=e.thumbs.swiper;if(!i||i.destroyed)return;const a=i.params.slidesPerView==="auto"?i.slidesPerViewDynamic():i.params.slidesPerView;let h=1;const n=e.params.thumbs.slideThumbActiveClass;if(e.params.slidesPerView>1&&!e.params.centeredSlides&&(h=e.params.slidesPerView),e.params.thumbs.multipleActiveThumbs||(h=1),h=Math.floor(h),i.slides.forEach(f=>f.classList.remove(n)),i.params.loop||i.params.virtual&&i.params.virtual.enabled)for(let f=0;f<h;f+=1)H(i.slidesEl,`[data-swiper-slide-index="${e.realIndex+f}"]`).forEach(m=>{m.classList.add(n)});else for(let f=0;f<h;f+=1)i.slides[e.realIndex+f]&&i.slides[e.realIndex+f].classList.add(n);const w=e.params.thumbs.autoScrollOffset,A=w&&!i.params.loop;if(e.realIndex!==i.realIndex||A){const f=i.activeIndex;let m,M;if(i.params.loop){const U=i.slides.filter(N=>N.getAttribute("data-swiper-slide-index")===`${e.realIndex}`)[0];m=i.slides.indexOf(U),M=e.activeIndex>e.previousIndex?"next":"prev"}else m=e.realIndex,M=m>e.previousIndex?"next":"prev";A&&(m+=M==="next"?w:-1*w),i.visibleSlidesIndexes&&i.visibleSlidesIndexes.indexOf(m)<0&&(i.params.centeredSlides?m>f?m=m-Math.floor(a/2)+1:m=m+Math.floor(a/2)-1:m>f&&i.params.slidesPerGroup,i.slideTo(m,r?0:void 0))}}c("beforeInit",()=>{const{thumbs:r}=e.params;if(!(!r||!r.swiper))if(typeof r.swiper=="string"||r.swiper instanceof HTMLElement){const i=z(),a=()=>{const n=typeof r.swiper=="string"?i.querySelector(r.swiper):r.swiper;if(n&&n.swiper)r.swiper=n.swiper,_(),b(!0);else if(n){const w=A=>{r.swiper=A.detail[0],n.removeEventListener("init",w),_(),b(!0),r.swiper.update(),e.update()};n.addEventListener("init",w)}return n},h=()=>{if(e.destroyed)return;a()||requestAnimationFrame(h)};requestAnimationFrame(h)}else _(),b(!0)}),c("slideChange update resize observerUpdate",()=>{b()}),c("setTransition",(r,i)=>{const a=e.thumbs.swiper;!a||a.destroyed||a.setTransition(i)}),c("beforeDestroy",()=>{const r=e.thumbs.swiper;!r||r.destroyed||g&&r.destroy()}),Object.assign(e.thumbs,{init:_,update:b})}const te="https://two024-south-json-server-vercel.onrender.com",se={components:{Swiper:G,SwiperSlide:J},data(){return{attractionTitle:"",attractions:[],enabledAttractions:[],imagesUrl:"",showModal:!1,modalImageFilePath:"",modalImageIndex:0,bigModal:null}},methods:{openModal(t,e){this.bigModal.show(),this.modalImageFilePath=t,this.modalImageIndex=e,this.showModal=!0},getAttractions(){this.axios.get(`${te}/attractions`).then(t=>{this.attractions=t.data,this.attractions.forEach(e=>{e.is_enabled===1&&this.attractionTitle===e.title&&this.enabledAttractions.push(e)}),this.imagesUrl=this.enabledAttractions[0].imagesUrl}).catch(t=>{v.threeLayerCheckType("error","取得景點資料失敗")})}},setup(){const t=X(null);return{thumbsSwiper:t,setThumbsSwiper:d=>{t.value=d},modules:[Q,K,ee]}},mounted(){this.bigModal=new W(this.$refs.bigModal,{keyboard:!1,backdrop:"static"}),this.attractionTitle=this.$route.params.title,this.getAttractions()}},L=t=>(D("data-v-1ea3f35b"),t=t(),j(),t),ie=["src"],re=["onClick"],oe=L(()=>s("i",{class:"bi bi-zoom-in fs-2"},null,-1)),ae=[oe],ne=L(()=>s("button",{class:"swiper-button-next border-0 bg-transparent"},null,-1)),le=L(()=>s("button",{class:"swiper-button-prev border-0 bg-transparent"},null,-1)),ce=["src"],de={class:"modal fade",id:"bigModal",tabindex:"-1","aria-labelledby":"bigModalLabel","aria-hidden":"true",ref:"bigModal"},ue={class:"modal-dialog modal-dialog-centered modal-xl"},he={class:"modal-content bg-transparent"},pe={class:"modal-body p-0"},me=["src"],be=L(()=>s("button",{type:"button",class:"border-0 bg-transparent position-absolute top-3 end-3 p-3","data-bs-dismiss":"modal","aria-label":"Close"},[s("i",{class:"bi bi-x-lg text-secondary-400 fs-3"})],-1));function fe(t,e,d,c,o,g){const p=x("swiper-slide"),_=x("swiper");return l(),u(y,null,[T(_,{spaceBetween:10,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},thumbs:{swiper:c.thumbsSwiper},modules:c.modules,class:"mySwiper2"},{default:S(()=>[(l(!0),u(y,null,k(o.imagesUrl,(b,r)=>(l(),F(p,{key:r+123},{default:S(()=>[s("img",{src:b,class:"img-fluid"},null,8,ie),s("button",{class:"position-absolute text-white end-5 bottom-5 fs-4 bg-transparent border-0",onClick:i=>g.openModal(b,r)},ae,8,re)]),_:2},1024))),128)),ne,le]),_:1},8,["navigation","thumbs","modules"]),T(_,{onSwiper:c.setThumbsSwiper,spaceBetween:10,slidesPerView:4,freeMode:!0,watchSlidesProgress:!0,modules:c.modules,class:"mySwiper3"},{default:S(()=>[(l(!0),u(y,null,k(o.imagesUrl,(b,r)=>(l(),F(p,{key:r+123},{default:S(()=>[s("img",{src:b,class:"img-fluid"},null,8,ce)]),_:2},1024))),128))]),_:1},8,["onSwiper","modules"]),s("div",de,[s("div",ue,[s("div",he,[s("div",pe,[s("img",{src:o.modalImageFilePath,class:"modal-content position-relative"},null,8,me),be])])])],512)],64)}const ge=V(se,[["render",fe],["__scopeId","data-v-1ea3f35b"]]),C="https://two024-south-json-server-vercel.onrender.com",we={components:{singleAttraction:ge,BannerBlock:Z,LikeBlock:R},data(){return{category:"",attractionTitle:"",attractions:[],enabledAttractions:[],newAttractionsContent:"",newAttractionsTimeOpen:"",attractionId:"",heartData:[],isFavorite:{},userId:"",token:"",isLoading:!1,attractionImageUrl:""}},methods:{redirectToA(t){this.$router.push({path:"/TouristAttractions",query:{category:t}})},getHeartData(){this.axios.get(`${C}/hearts`).then(t=>{t.data.forEach(e=>{e.userId===this.userId&&e.tag==="旅遊景點"&&(this.isFavorite[e.product]=!0)})}).catch(t=>{v.threeLayerCheckType("error","取得愛心收藏資料失敗")})},toggleFavorite(t,e,d,c){this.token?this.axios.get(`${C}/hearts`).then(o=>{const g=o.data.find(p=>p.product===t&&p.userId===this.userId&&p.tag==="旅遊景點");g?this.axios.delete(`${C}/hearts/${g.id}`).then(p=>{this.isFavorite[t]=!1,v.threeLayerCheckType("success",`取消收藏 ${d} 成功`),this.getHeartData()}).catch(p=>{v.threeLayerCheckType("error","取消收藏資料失敗")}):this.axios.post(`${C}/hearts`,{product:t,category:e,title:d,userId:this.userId,tag:"旅遊景點",imageUrl:c}).then(p=>{this.isFavorite[t]=!0,v.threeLayerCheckType("success",`已加入收藏 ${d} 成功`),this.getHeartData()}).catch(p=>{v.threeLayerCheckType("error","收藏資料失敗")})}).catch(o=>{v.threeLayerCheckType("error","取得愛心收藏資料失敗")}):v.threeLayerCheckType("warning","請登入會員後，才能加入收藏")},getAttractions(){this.axios.get(`${C}/attractions`).then(t=>{this.attractions=t.data,this.attractions.forEach(e=>{e.is_enabled===1&&this.attractionTitle===e.title&&(this.enabledAttractions.push(e),this.attractionId=e.id,this.isLoading=!1,this.attractionImageUrl=e.imageUrl)}),this.getNewText(),this.getnewAttractionsTimeOpen()}).catch(()=>{v.threeLayerCheckType("error","取得景點資料失敗")})},getNewText(){const t={};this.attractions.forEach(e=>{e.content&&e.content.split(";").forEach(c=>{const o=c.trim();t[e.id]||(t[e.id]=[]),t[e.id].push(o)})}),this.newProductsContent=Object.entries(t).map(([e,d])=>({id:e,content:d}))},getnewAttractionsTimeOpen(){const t={};this.attractions.forEach(e=>{e.content&&e.timeOpen.split(";").forEach(c=>{const o=c.trim();t[e.id]||(t[e.id]=[]),t[e.id].push(o)})}),this.newAttractionsTimeOpen=Object.entries(t).map(([e,d])=>({id:e,content:d}))},getCookie(t){const e=document.cookie.split(";");for(let d of e){const[c,o]=d.trim().split("=");if(c===t)return o}return null}},mounted(){this.category=this.$route.params.category,this.attractionTitle=this.$route.params.title;const t=this.getCookie("userId"),e=this.getCookie("hexTokenU");this.userId=t*1,this.token=e,this.isLoading=!0,this.getAttractions(),this.getHeartData(),window.scrollTo(0,0)}},B=t=>(D("data-v-464fd62f"),t=t(),j(),t),_e={class:"container py-10 py-lg-30 px-lg-20"},ve={style:{"--bs-breadcrumb-divider":"'>'"},"aria-label":"breadcrumb",class:"pb-5 pb-lg-15"},ye={class:"breadcrumb mb-0 fs-5"},Te={class:"breadcrumb-item"},ke={class:"breadcrumb-item"},xe={class:"breadcrumb-item"},Ie={class:"breadcrumb-item"},Se={class:"d-flex align-items-center mb-4 fs-3 border-start border-primary-500 border-5"},Ce={class:"fs-3 me-2 fw-bold ps-3"},Ae={class:"fs-3 me-4 fw-bold"},Le={key:0},Me={class:"tourist-intr-content my-lg-10 my-8"},Pe={class:"mb-8"},Ee=B(()=>s("p",{class:"fs-5 fs-md-4 fw-bold mb-4"},"景點介紹",-1)),Oe={class:"fs-6 fs-md-5"},Be={class:"mb-8"},Fe=B(()=>s("span",{class:"fs-5 fs-md-4 mb-4 fw-bold"},"開放時間：",-1)),$e={key:0},Ve=B(()=>s("p",{class:"fs-5 fs-md-4 mb-3 fw-bold"},"交通資訊：",-1)),De={class:"row"},je={class:"d-flex col-12 col-lg-7 justify-content-between flex-column"},Ue={key:0},Ne={class:"col-12 col-lg-5"},ze=["src"];function qe(t,e,d,c,o,g){const p=x("VueLoading"),_=x("BannerBlock"),b=x("router-link"),r=x("singleAttraction"),i=x("LikeBlock");return l(),u(y,null,[T(p,{active:o.isLoading,class:"text-center","z-index":1060},null,8,["active"]),T(_),s("div",_e,[s("nav",ve,[s("ol",ye,[s("li",Te,[T(b,{to:"/",exact:"","active-class":"active-link"},{default:S(()=>[$("首頁")]),_:1})]),s("li",ke,[T(b,{exact:"","active-class":"active-link",to:{path:"/TouristAttractions",query:{category:"全部",page:"1"}}},{default:S(()=>[$(" 南部旅遊景點 ")]),_:1})]),s("li",xe,[P(s("a",{onClick:e[0]||(e[0]=a=>g.redirectToA("台南")),class:"navbar-brand"},"台南",512),[[E,o.category==="台南"]]),P(s("a",{onClick:e[1]||(e[1]=a=>g.redirectToA("嘉義")),class:"navbar-brand"},"嘉義",512),[[E,o.category==="嘉義"]]),P(s("a",{onClick:e[2]||(e[2]=a=>g.redirectToA("高雄")),class:"navbar-brand"},"高雄",512),[[E,o.category==="高雄"]])]),s("li",Ie,I(o.attractionTitle),1)])]),s("div",Se,[s("span",Ce,I(o.category),1),s("p",Ae,I(o.attractionTitle),1),s("button",{class:"border-0 heart-position-none fs-3 bg-transparent",onClick:e[3]||(e[3]=a=>g.toggleFavorite(o.attractionId,o.category,o.attractionTitle,o.attractionImageUrl)),type:"button"},[s("i",{class:Y(["bi",{"bi-heart-fill":o.isFavorite[o.attractionId],"bi-heart":!o.isFavorite[o.attractionId]}])},null,2)])]),T(r),(l(!0),u(y,null,k(o.enabledAttractions,(a,h)=>(l(),u("div",{class:"row g-3",key:a.id},[h===0?(l(),u("div",Le,[s("div",Me,[s("div",Pe,[Ee,s("p",Oe,I(a.description),1)]),s("div",Be,[Fe,(l(!0),u(y,null,k(o.newAttractionsTimeOpen,n=>(l(),u("div",{key:n.id},[n.id===a.id?(l(),u("div",$e,[(l(!0),u(y,null,k(n.content,w=>(l(),u("p",{key:w+123,class:"fs-6 fs-md-5 my-4"},I(w),1))),128))])):O("",!0)]))),128))]),s("div",null,[Ve,s("div",De,[s("div",je,[(l(!0),u(y,null,k(t.newProductsContent,n=>(l(),u("div",{key:n.id},[n.id===a.id?(l(),u("div",Ue,[(l(!0),u(y,null,k(n.content,w=>(l(),u("p",{key:w,class:"fs-6 fs-md-5 my-4 mb-4"},I(w),1))),128))])):O("",!0)]))),128))]),s("div",Ne,[s("iframe",{src:a.imgMap,width:"100%",height:"100%",style:{border:"0"},allowfullscreen:"",loading:"lazy",referrerpolicy:"no-referrer-when-downgrade"},null,8,ze)])])])])])):O("",!0)]))),128)),T(i,{adCategoryTitle:"attractions",token:o.token,"user-id":o.userId},null,8,["token","user-id"])])],64)}const Xe=V(we,[["render",qe],["__scopeId","data-v-464fd62f"]]);export{Xe as default};
