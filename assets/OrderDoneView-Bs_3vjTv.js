import{U as C}from"./UserProductModal-hVwLXBIz.js";import{C as v}from"./CartNavbar-79_qkU_G.js";import{C as u}from"./collapse-2HEcf_yr.js";import{_ as I,c,a as s,b as p,d as n,t as o,f as _,v as g,F as b,h as x,n as y,r as m,o as a}from"./index-EB2s3bge.js";const h="https://two024-south-json-server-vercel.onrender.com",k={components:{CartNavbar:v,UserProductModal:C},data(){return{userId:"",total:0,cartsData:[],userCart:[],isOpen:!0,isOrderOpen:!0,headerCollapse:{},products:[],product:{},cartTotal:0,orderData:[],userOrder:"",product_id:"",productId:"",productTitle:"",orderId:0}},watch:{$route(){this.headerCollapse.hide(),this.orderCollapse.hide()}},methods:{backPage(){this.$router.go(-1)},toggleOpen(){this.isOpen=!this.isOpen},toggleOpenOrder(){this.isOrderOpen=!this.isOrderOpen},forId(e,t){this.productId=e,this.productTitle=t,this.$refs.userProductModal.openModal()},getOderData(){this.axios.get(`${h}/orders`).then(e=>{this.orderData=e.data,this.orderData.forEach(t=>{t.user.userId===this.userId&&t.status===!1&&(this.userOrder=t.user)})}).catch(e=>{console.log(e)})},getCartsData(){this.axios.get(`${h}/cartsData`).then(e=>{this.cartsData=e.data,this.cartsData.forEach(t=>{t.orderStatus===!1&&t.orderId===this.orderId&&t.data.forEach(i=>{i.userId===this.userId&&this.userCart.push(i)})}),this.userCart.forEach(t=>{this.total+=t.final_total})}).catch(e=>{console.log(e)})},getCookie(e){const i=`; ${document.cookie}`.split(`; ${e}=`);if(i.length===2)return i.pop().split(";").shift()},getCart(){this.axios.get(`${h}/carts`).then(e=>{this.userCarts=e.data.filter(t=>t.userId===this.userId),this.cartsLength=this.userCarts.length,console.log(this.cartsLength,this.userCarts),this.userCarts.length===0?this.$emitter.emit("updateCartNum",0):this.$emitter.emit("updateCartNum",this.userCarts.length)}).catch(e=>{console.log(e),alert("取得購物車資料失敗")})},thousand(e){return e!==void 0&&(e=e.toString().replace(new RegExp("\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))","g"),",")),`$ ${e}`}},mounted(){const e=this.getCookie("userId");this.userId=e*1;const t=this.getCookie("orderId");this.orderId=t*1,setTimeout(()=>{document.cookie="orderId=; expires="},3e3),this.getOderData(),this.getCartsData(),this.headerCollapse=new u(this.$refs.headerCollapse,{toggle:!1}),this.orderCollapse=new u(this.$refs.orderCollapse,{toggle:!1}),console.log(this.$route),this.getCart()}},w={class:"container py-10 py-lg-30"},D={class:"row"},E={class:"col-md-6 mx-auto pb-5 pb-lg-15"},M=s("div",{class:"text-center mb-10"},[s("div",{class:"text-center"},[s("i",{class:"bi bi-check-circle-fill text-success fs-3"}),s("p",{class:"fs-4"},"感謝您！您的訂單已建立完成")])],-1),N={class:"row"},T={class:"mb-4"},P={class:"d-grid gap-2"},U=s("br",null,null,-1),B={key:0,class:"bi bi-chevron-down"},S={key:1,class:"bi bi-chevron-up"},V={class:"collapse show",id:"collapseExample",ref:"headerCollapse"},j={class:"card card-body rounded-0"},q={class:"col-12 col-md-5 col-lg-4"},L=["src","alt"],F={class:"col-12 col-md-7 col-lg-8 d-flex flex-column justify-content-between"},z={class:"mt-4 mt-md-0 mb-4"},A={class:"mb-4"},G={class:"mb-4"},H={class:"mb-4"},J=["onClick"],K={class:"mb-4 col-12"},Q={class:"d-grid gap-2"},R=s("br",null,null,-1),W={key:0,class:"bi bi-chevron-down"},X={key:1,class:"bi bi-chevron-up"},Y={class:"collapse show",id:"collapseOrder",ref:"orderCollapse"},Z={class:"card card-body rounded-0",style:{height:"350px"}},$={class:"row p-4 p-md-10"},ss={class:"col-12 col-md-6 col-lg-6"},es={class:"mb-4"},ts={class:"mb-4"},rs={class:"mb-4"},os={class:"mb-4"},ls={class:"mb-4"},ds={class:"col-12 col-md-6 col-lg-6"},cs={class:"mb-4"},as={class:"mb-4"},is={class:"mb-4"},ns=s("div",{class:"d-flex justify-content-center"},[s("div",{class:"w-100 w-md-25"},[s("a",{class:"btn-square mt-4 fs-5 w-100",type:"button",href:"#"},"回首頁")])],-1);function hs(e,t,i,us,r,d){const f=m("CartNavbar"),O=m("UserProductModal");return a(),c(b,null,[s("div",w,[s("div",D,[s("div",E,[p(f)])]),M,s("div",N,[s("div",T,[s("p",P,[s("button",{class:"btn btn-primary-600 border-top",type:"button","data-bs-toggle":"collapse","data-bs-target":"#collapseExample","aria-expanded":"false","aria-controls":"collapseExample",onClick:t[0]||(t[0]=(...l)=>d.toggleOpen&&d.toggleOpen(...l))},[n(" 總計："+o(d.thousand(r.total))+"元",1),U,n("購買清單 "),r.isOpen===!1?(a(),c("i",B)):(a(),c("i",S))])]),_(s("div",V,[s("div",j,[(a(!0),c(b,null,x(r.userCart,l=>(a(),c("div",{class:"row p-4 p-md-10",key:l.id},[s("div",q,[s("img",{src:l.product.imageUrl,alt:l.product.title,class:"img-fluid h-100"},null,8,L)]),s("div",F,[s("div",null,[s("h4",z,"套裝行程名稱："+o(l.product.title),1),s("h5",A,"單價："+o(d.thousand(l.product.price)),1),s("h5",G,"預約數量："+o(l.qty)+" 位",1),s("h5",H,"總計："+o(d.thousand(l.final_total)),1)]),s("div",null,[s("button",{type:"button",class:"btn-turquoise border-0 rounded-1",onClick:ps=>d.forId(l.product.id,l.product.title)}," 查看更多 ",8,J)])])]))),128))])],512),[[g,r.isOpen]])]),s("div",K,[s("p",Q,[s("button",{class:"btn btn-primary-600 border-top",type:"button","data-bs-toggle":"collapse","data-bs-target":"#collapseOrder","aria-expanded":"true","aria-controls":"collapseOrder",onClick:t[1]||(t[1]=(...l)=>d.toggleOpenOrder&&d.toggleOpenOrder(...l))},[n(" 訂單資料及收件方式"),R,r.isOrderOpen===!1?(a(),c("i",W)):(a(),c("i",X))])]),_(s("div",Y,[s("div",Z,[s("div",$,[s("div",ss,[s("h5",es," 主要聯繫人名字："+o(r.userOrder.name)+" "+o(r.userOrder.appellation==="female"?"女士":"男士"),1),s("h5",ts,"主要聯繫人電話："+o(r.userOrder.tel),1),s("h5",rs,"主要聯繫人身分證字號："+o(r.userOrder.memberId),1),s("h5",os,"主要聯繫人護照號碼："+o(r.userOrder.passport),1),s("h5",ls,"主要聯繫人地址："+o(r.userOrder.address),1)]),s("div",ds,[s("h5",cs,"收取方式："+o(r.userOrder.shippingMethod),1),s("h5",as,"付款方式："+o(r.userOrder.payMethod),1),s("h5",is,[n(" 付款狀態： "),s("span",{class:y({"text-danger":r.userOrder.status===!1,"text-success":r.userOrder.status===!0})},o(r.userOrder.status?"已付款":"未付款"),3)]),s("h5",null,"備註："+o(r.userOrder.comment),1)])])])],512),[[g,r.isOrderOpen]])])]),ns]),p(O,{ref:"userProductModal",userCart:r.userCart,productId:r.productId,productTitle:r.productTitle},null,8,["userCart","productId","productTitle"])],64)}const fs=I(k,[["render",hs]]);export{fs as default};
