import"./sweetalert2.all-IALlFI-O.js";import{_ as v,c as r,a as t,n as f,b as w,w as S,l as b,F as p,i as m,r as D,o,d as g,t as c,p as O,f as I}from"./index-GsItRNTP.js";const x="https://two024-south-json-server-vercel.onrender.com",C={data(){return{userId:"",token:"",orders:[],orderNum:"",orderDate:"",finalTotal:"",isOpen:!1,selectedOrder:null,cartsData:"",ordersLength:""}},methods:{showDetails(s){this.selectedOrder=this.selectedOrder===s?-1:s},getNewOrderNum(s){var a=new Date(s.user.create_at),i=a.toISOString(),u=i.slice(0,10),l=u.replace(/-/g,"");return l+this.formatId(s.id)},getOrderNum(s){return this.formatId(s.id)},getOrderDate(s){var a=new Date(s.user.create_at),i=a.toISOString(),u=i.slice(0,10);return u},formatId(s){return s.toString().padStart(3,"0")},getOrders(){this.axios.get(`${x}/orders?_embed=cartsData`).then(s=>{this.orders=s.data.filter(a=>a.user.userId===this.userId),this.ordersLength=this.orders.length,console.log(this.ordersLength)}).catch(s=>{console.log(s)})},thousand(s){return s!==void 0&&(s=s.toString().replace(new RegExp("\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))","g"),",")),`$ ${s}`},getCookie(s){const a=document.cookie.split(";");for(let i of a){const[u,l]=i.trim().split("=");if(u===s)return l}return null}},mounted(){window.scrollTo(0,0),this.isLoading=!0;const s=this.getCookie("userId"),a=this.getCookie("hexTokenU");this.userId=s*1,this.token=a,this.getOrders()}},_=s=>(O("data-v-fa847cc3"),s=s(),I(),s),N={class:"table table-bordered table-hover"},T=_(()=>t("thead",null,[t("tr",{class:"bg-primary-400 align-middle fs-7 fs-md-6 text-center"},[t("th",{scope:"col"},"序號"),t("th",{scope:"col",class:"mw-2"},"訂單編號"),t("th",{scope:"col",class:"mw-2"},"訂購日期"),t("th",{scope:"col",class:"mw-2"},"購買金額"),t("th",{scope:"col",class:"mw-2"},"訂單狀態"),t("th",{scope:"col",class:"mw-1"},"操作")])],-1)),L={colspan:"6",class:"table-hover-style p-10"},V=_(()=>t("p",{class:"text-center mb-5 fs-5"},[g("目前沒有可用的訂單資料。"),t("br"),g("欲查看旅遊方案或進行購買，請點擊下方的連結。")],-1)),q={class:"d-flex justify-content-center"},B={scope:"row",class:"align-middle text-center fs-8 fs-md-6"},P={class:"align-middle fs-8 fs-md-6"},j={class:"align-middle fs-8 fs-md-6"},F={class:"align-middle fs-8 fs-md-6"},U={class:"align-middle fs-8 fs-md-6"},z={key:0,class:"text-primary-emphasis"},E={key:1,class:"text-primary"},A={key:2,class:"text-warning"},G={key:3,class:"text-danger"},H={key:4,class:"text-success"},J={class:"align-middle"},K=["onClick"],M=["onClick"],Q=_(()=>t("tr",null,[t("td",{colspan:"6",class:"table-hover-style border-0"})],-1)),R=_(()=>t("tr",null,[t("td",{class:"table-hover-style border-left-trans"}),t("th",{colspan:"5",class:"align-middle text-center bg-primary-200"},"購買訂單資料")],-1)),W=_(()=>t("tr",null,[t("td",{class:"table-hover-style border-left-trans"}),t("td",{colspan:"2",class:"bg-primary-300"},"產品名稱"),t("td",{class:"bg-primary-300"},"單價"),t("td",{class:"bg-primary-300"},"數量"),t("td",{class:"bg-primary-300"},"小計")],-1)),X=_(()=>t("td",{colspan:"1",class:"table-hover-style border-left-trans border-bottom-trans"},null,-1)),Y={colspan:"2",class:"fs-8 fs-md-6"},Z={class:"fs-8 fs-md-6"},$={class:"fs-8 fs-md-6"},tt={class:"fs-8 fs-md-6"};function st(s,a,i,u,l,d){const k=D("router-link");return o(),r("table",N,[T,t("tbody",null,[l.ordersLength===0?(o(),r("tr",{key:0,class:f(["table-style",{"bg-active":l.selectedOrder===s.index}])},[t("td",L,[V,t("div",q,[w(k,{to:"/TouristPackage",class:"btn-turquoise w-25 text-center"},{default:S(()=>[g("南部旅遊方案")]),_:1})])])],2)):b("",!0),(o(!0),r(p,null,m(l.orders,(e,n)=>(o(),r(p,{key:n+123},[t("tr",{class:f(["table-style",{"bg-active":l.selectedOrder===n}])},[t("th",B,c(n+1),1),t("td",P,c(d.getNewOrderNum(e)),1),t("td",j,c(d.getOrderDate(e)),1),t("td",F,c(d.thousand(e.cartsData[0].final_total)),1),t("td",U,[!e.status&&!e.billStatus&&!e.checkDataStatus&&!e.user.status?(o(),r("span",z," 訂單處理中 ")):!e.status&&!e.billStatus&&!e.checkDataStatus&&e.user.status?(o(),r("span",E," 預約安排出遊 ")):!e.status&&!e.billStatus&&e.checkDataStatus&&e.user.status?(o(),r("span",A," 發票開立中 ")):!e.status&&e.billStatus&&e.checkDataStatus&&e.user.status?(o(),r("span",G," 訂單即將完成，準備出遊 ")):(o(),r("span",H,"已出遊結束"))]),t("td",J,[t("button",{class:"btn-outline-turquoise w-100 d-none d-md-block",type:"button",onClick:h=>d.showDetails(n)}," 查看詳情 ",8,K),t("button",{class:"btn-outline-turquoise w-100 d-md-none",type:"button",onClick:h=>d.showDetails(n)}," 詳情 ",8,M)])],2),l.selectedOrder===n?(o(),r(p,{key:0},[Q,R,W,(o(!0),r(p,null,m(e.cartsData[0].data,(h,y)=>(o(),r("tr",{key:y+123},[X,t("td",Y,c(h.product.title),1),t("td",Z,c(d.thousand(h.price)),1),t("td",$,c(h.qty),1),t("td",tt,c(d.thousand(h.final_total)),1)]))),128)),t("tr",null,[t("td",{colspan:"6",class:f(["border-0 border-left-trans table-hover-style",{"border-bottom-trans":n===l.ordersLength-1}])},null,2)])],64)):b("",!0)],64))),128))])])}const ot=v(C,[["render",st],["__scopeId","data-v-fa847cc3"]]);export{ot as default};
