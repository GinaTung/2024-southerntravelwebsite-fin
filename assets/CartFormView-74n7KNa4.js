import{U as y}from"./UserProductModal-BdiW2Wtd.js";import{C as D}from"./CartNavbar-f8n45jFl.js";import{C}from"./collapse-LyNnNbLH.js";import{_ as x,c,a as t,b as m,d as f,t as u,f as a,v as k,F as _,h as w,i as n,B as b,r as g,o as p}from"./index-CnCUfF1T.js";const h="https://two024-south-json-server-vercel.onrender.com",M={components:{CartNavbar:D,UserProductModal:y},data(){return{cartsData:[],userCart:[],userId:"",isOpen:!1,headerCollapse:{},order:{},user:{name:"",email:"",tel:"",address:"",birthday:"",comment:"",shippingMethod:"",passport:"",memberId:"",appellation:""},shippingMethod:["電子郵件","郵寄"],total:0,productId:"",productTitle:"",cartDataId:"",ordersData:[]}},watch:{$route(){this.headerCollapse.hide()}},methods:{backPage(){this.$router.go(-1)},toggleOpen(){this.isOpen=!this.isOpen},forId(l,e){this.productId=l,this.productTitle=e,this.$refs.userProductModal.openModal()},getCart(){this.axios.get(`${h}/cartsData`).then(l=>{this.cartsData=l.data,this.cartsData.forEach(e=>{this.cartDataId=e.id,e.status===!1&&e.data.forEach(r=>{r.userId===this.userId&&this.userCart.push(r)})}),this.userCart.forEach(e=>{this.total+=e.final_total}),console.log(this.cartDataId)}).catch(l=>{console.log(l)})},getCookie(l){const e=document.cookie.split(";");for(let r of e){const[i,o]=r.trim().split("=");if(i===l)return o}return null},thousand(l){return l!==void 0&&(l=l.toString().replace(new RegExp("\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))","g"),",")),`$ ${l}`},getOderData(){this.axios.get(`${h}/orders`).then(l=>{this.ordersData=l.data}).catch(l=>{console.log(l)})},orderData(){const l=this.ordersData.some(r=>r.user.cartDataId===this.cartDataId&&r.user.status===!1);let e=0;if(this.ordersData.forEach(r=>{r.user.cartDataId===this.cartDataId&&r.user.status===!1&&(e=r.id)}),l){const r={create_at:new Date,name:this.user.name,email:this.user.email,tel:this.user.tel,address:this.user.address,birthday:this.user.birthday,comment:this.user.comment,shippingMethod:this.user.shippingMethod,passport:this.user.passport,memberId:this.user.memberId,appellation:this.user.appellation,userId:this.userId,cartDataId:this.cartDataId,status:!1};this.axios.put(`${h}/orders/${e}`,{user:r}).then(i=>{this.order=i.data}).catch(i=>{console.log(i)})}else{const r={create_at:new Date,name:this.user.name,email:this.user.email,tel:this.user.tel,address:this.user.address,birthday:this.user.birthday,comment:this.user.comment,shippingMethod:this.user.shippingMethod,passport:this.user.passport,memberId:this.user.memberId,appellation:this.user.appellation,userId:this.userId,cartDataId:this.cartDataId,status:!1};this.axios.post(`${h}/orders`,{user:r}).then(i=>{this.order=i.data}).catch(i=>{console.log(i)})}}},mounted(){const l=this.getCookie("userId");this.getCookie("cartDataId"),this.userId=l*1,this.getCart(),this.getOderData(),this.headerCollapse=new C(this.$refs.headerCollapse,{toggle:!1})}},U={class:"container py-10 py-lg-30"},V={class:"row"},E={class:"col-md-6 mx-auto pb-5 pb-lg-15"},T={class:"mb-4"},O={class:"d-grid gap-2"},P=t("br",null,null,-1),N={key:0,class:"bi bi-chevron-down"},S={key:1,class:"bi bi-chevron-up"},B={class:"collapse",id:"collapseExample",ref:"headerCollapse"},F={class:"card card-body rounded-0"},A={class:"col-12 col-md-5 col-lg-4"},j=["src","alt"],q={class:"col-12 col-md-7 col-lg-8 d-flex flex-column justify-content-between"},L={class:"mt-4 mt-md-0 mb-4"},z={class:"mb-4"},G={class:"mb-4"},H={class:"mb-4"},J=["onClick"],K={class:"row"},Q={class:"col-12 col-md-6 mb-4"},R=t("h3",{class:"mb-4"},"訂單資料",-1),W={class:"form-floating mb-4"},X=t("label",{for:"floatingInput"},"主要聯繫人",-1),Y={class:"form-floating mb-4"},Z=t("option",{selected:"",value:"",disabled:""},"請選擇稱謂",-1),$=t("option",{value:"female"},"女士",-1),tt=t("option",{value:"male"},"男士",-1),et=[Z,$,tt],st=t("label",{for:"floatingAppellation"},"稱謂",-1),ot={class:"form-floating mb-4"},lt=t("label",{for:"floatingMemberId"},"身分證字號",-1),rt={class:"form-floating mb-4"},at=t("label",{for:"floatingPassport"},"護照號碼",-1),it={class:"form-floating mb-4"},dt=t("label",{for:"floatingDate"},"生日",-1),nt={class:"form-floating mb-4"},ct=t("label",{for:"floatingTel"},"電話",-1),ut={class:"form-floating mb-4"},pt=t("label",{for:"floatingEmail"},"電子郵件",-1),ht={class:"form-floating mb-4"},mt=t("label",{for:"floatingAddress"},"住址",-1),ft={class:"col-12 col-md-6 mb-4"},_t=t("h3",{class:"mb-4"},"取件方式",-1),bt={class:"form-floating mb-4"},gt=t("option",{selected:"",value:"",disabled:""},"請選擇取件方式",-1),vt=t("option",{value:"電子郵件"},"電子郵件",-1),It=t("option",{value:"郵寄"},"郵寄",-1),yt=[gt,vt,It],Dt=t("label",{for:"floatingSelect2"},"選擇取件方式",-1),Ct={class:"form-floating mb-4"},xt=t("label",{for:"floatingTextarea2"},"備註(如:飲食、暈車等注意事項)",-1),kt={class:"d-flex justify-content-between"};function wt(l,e,r,i,o,d){const v=g("CartNavbar"),I=g("UserProductModal");return p(),c(_,null,[t("div",U,[t("div",V,[t("div",E,[m(v)])]),t("div",T,[t("p",O,[t("button",{class:"btn btn-primary-600 border-top",type:"button","data-bs-toggle":"collapse","data-bs-target":"#collapseExample","aria-expanded":"false","aria-controls":"collapseExample",onClick:e[0]||(e[0]=(...s)=>d.toggleOpen&&d.toggleOpen(...s))},[f(" 總計："+u(d.thousand(o.total))+"元",1),P,f("購買清單 "),o.isOpen===!1?(p(),c("i",N)):(p(),c("i",S))])]),a(t("div",B,[t("div",F,[(p(!0),c(_,null,w(o.userCart,s=>(p(),c("div",{class:"row p-4 p-md-10",key:s.id},[t("div",A,[t("img",{src:s.product.imageUrl,alt:s.product.title,class:"img-fluid h-100"},null,8,j)]),t("div",q,[t("div",null,[t("h4",L,"套裝行程名稱："+u(s.product.title),1),t("h5",z,"單價："+u(d.thousand(s.product.price)),1),t("h5",G,"預約數量："+u(s.qty)+" 位",1),t("h5",H,"總計："+u(d.thousand(s.final_total)),1)]),t("div",null,[t("button",{type:"button",class:"btn-turquoise border-0 rounded-1",onClick:Mt=>d.forId(s.product.id,s.product.title)}," 查看更多 ",8,J)])])]))),128))])],512),[[k,o.isOpen]])]),t("div",K,[t("div",Q,[R,t("div",W,[a(t("input",{type:"text",class:"form-control rounded-1",id:"floatingInput",placeholder:"王小明","onUpdate:modelValue":e[1]||(e[1]=s=>o.user.name=s)},null,512),[[n,o.user.name]]),X]),t("div",Y,[a(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>o.user.appellation=s),class:"form-select rounded-1",id:"floatingAppellation","aria-label":"Floating label select example"},et,512),[[b,o.user.appellation]]),st]),t("div",ot,[a(t("input",{type:"text",class:"form-control rounded-1",id:"floatingMemberId",placeholder:"身分證字號","onUpdate:modelValue":e[3]||(e[3]=s=>o.user.memberId=s)},null,512),[[n,o.user.memberId]]),lt]),t("div",rt,[a(t("input",{type:"text",class:"form-control rounded-1",id:"floatingPassport",placeholder:"護照號碼","onUpdate:modelValue":e[4]||(e[4]=s=>o.user.passport=s)},null,512),[[n,o.user.passport]]),at]),t("div",it,[a(t("input",{type:"date",class:"form-control rounded-1",id:"floatingDate",placeholder:"2024/03/08","onUpdate:modelValue":e[5]||(e[5]=s=>o.user.birthday=s)},null,512),[[n,o.user.birthday]]),dt]),t("div",nt,[a(t("input",{type:"tel",class:"form-control rounded-1",id:"floatingTel",placeholder:"tel","onUpdate:modelValue":e[6]||(e[6]=s=>o.user.tel=s)},null,512),[[n,o.user.tel]]),ct]),t("div",ut,[a(t("input",{type:"email",class:"form-control rounded-1",id:"floatingEmail",placeholder:"name@example.com","onUpdate:modelValue":e[7]||(e[7]=s=>o.user.email=s)},null,512),[[n,o.user.email]]),pt]),t("div",ht,[a(t("input",{type:"text",class:"form-control rounded-1",id:"floatingAddress",placeholder:"縣市鄉鎮市區","onUpdate:modelValue":e[8]||(e[8]=s=>o.user.address=s)},null,512),[[n,o.user.address]]),mt])]),t("div",ft,[_t,t("div",bt,[a(t("select",{"onUpdate:modelValue":e[9]||(e[9]=s=>o.user.shippingMethod=s),class:"form-select rounded-1",id:"floatingSelect2","aria-label":"Floating label select example"},yt,512),[[b,o.user.shippingMethod]]),Dt]),t("div",Ct,[a(t("textarea",{class:"form-control rounded-1",placeholder:"備註",id:"floatingTextarea2",style:{height:"280px"},"onUpdate:modelValue":e[10]||(e[10]=s=>o.user.comment=s)},null,512),[[n,o.user.comment]]),xt])])]),t("div",kt,[t("a",{class:"btn-cerulean w-50 w-md-25 fs-5 mt-4 me-1",onClick:e[11]||(e[11]=(...s)=>d.backPage&&d.backPage(...s)),type:"button"},"上一步"),t("a",{class:"btn-square mt-4 fs-5 w-50 w-md-25",type:"button",href:"#/cart/payList",onClick:e[12]||(e[12]=(...s)=>d.orderData&&d.orderData(...s))},"下一步")])]),m(I,{ref:"userProductModal",userCart:o.userCart,productId:o.productId,productTitle:o.productTitle},null,8,["userCart","productId","productTitle"])],64)}const Ot=x(M,[["render",wt]]);export{Ot as default};
