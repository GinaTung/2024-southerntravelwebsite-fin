import{_ as x,c as o,b as m,a as t,w as p,g as A,F as g,h as v,n as u,A as _,r as C,o as r,d as y,t as n}from"./index-N7fZ8enQ.js";const b="https://two024-south-json-server-vercel.onrender.com",P={data(){return{allAttractions:[],enabledAttractions:[],searchChiayi:[],serchTainan:[],searchKaohsiung:[],fullPath:"",currentURL:"",selectedCategory:"全部",currentPage:1,limitPage:6,pageTotal:0,attractionsCategory:[],isLoading:!1,status:{loadingItem:!1},category:"全部"}},computed:{filterCategory(){const s=this.attractionsCategory.map(l=>l.category),e=[...new Set(s)];return e.unshift("全部"),e},filterCateNum(){const s={};return this.attractionsCategory.forEach(e=>{s[e.category]?s[e.category]+=1:s[e.category]=1}),s.全部=this.attractionsCategory.length,s},filteredProducts(){return this.selectedCategory==="全部"||!this.selectedCategory?this.enabledAttractions:this.enabledAttractions.filter(s=>s.category===this.selectedCategory)}},watch:{$route(s,e){this.currentURL=s.fullPath,this.$root.navigatedFromHeader&&s.fullPath!=="/TouristAttractions"&&(this.selectedCategory="全部",this.status.loadingItem=!0,this.getAttractions(),this.$root.navigatedFromHeader=!1)}},created(){this.category=this.$route.query.category,this.selectedCategory=this.category,this.getAttractions()},methods:{getAttractions(s=1){this.axios.get(`${b}/attractions`).then(e=>{this.attractionsCategory=e.data.filter(l=>l.is_enabled===1),setTimeout(()=>{this.isLoading=!1},1e3)}).catch(e=>{alert(`${e.message}`)}),this.selectedCategory==="全部"||!this.selectedCategory?this.axios.get(`${b}/attractions?_limit=${this.limitPage}&_page=${s}`).then(e=>{var l=parseInt(e.headers["x-total-count"]);this.pageTotal=Math.ceil(l/this.limitPage),this.currentPage=s,this.allAttractions=e.data,this.enabledAttractions=this.allAttractions.filter(d=>d.is_enabled===1),this.status.loadingItem=!1,this.$router.push({path:"/TouristAttractions",query:{category:this.selectedCategory,page:this.currentPage}}),window.scrollTo(0,0)}).catch(e=>{alert(`${e.message}`)}):this.axios.get(`${b}/attractions?category=${this.selectedCategory}&_limit=${this.limitPage}&_page=${s}`).then(e=>{var l=parseInt(e.headers["x-total-count"]);this.pageTotal=Math.ceil(l/this.limitPage),this.currentPage=s,this.allAttractions=e.data,this.enabledAttractions=this.allAttractions.filter(d=>d.is_enabled===1),this.status.loadingItem=!1,this.$router.push({path:"/TouristAttractions",query:{category:this.selectedCategory,page:this.currentPage}}),window.scrollTo(0,0)}).catch(e=>{alert(`${e.message}`)})},filterProducts(s){this.selectedCategory=s,this.status.loadingItem=!0,this.getAttractions()},truncateContent(s,e){return s&&s.length>e?s.substring(0,e)+"...":s}},mounted(){this.isLoading=!0,this.getAttractions(),window.scrollTo(0,0),this.fullPath=this.$route.fullPath}},w={class:"container py-10 py-lg-30"},T={style:{"--bs-breadcrumb-divider":"'>'"},"aria-label":"breadcrumb",class:"pb-5 pb-lg-15"},L={class:"breadcrumb mb-0 fs-5"},N={class:"breadcrumb-item"},V={class:"breadcrumb-item","aria-current":"page"},$={key:1},j={class:"tourist-list"},q={class:"row"},B={class:"col-12 col-md-3 mb-5 mb-md-6 mb-lg-0 d-none d-lg-flex"},F={class:"border-info2 border-1 border w-100 rounded-1 h-100"},I=t("p",{class:"fs-4 p-5 bg-primary-500 text-white"},"地區篩選",-1),M={class:"nav flex-column"},S=["value","onClick"],U={class:"col-12 col-lg-9"},z={key:0,class:"text-center",style:{margin:"150px"}},E=t("div",{class:"spinner-border",role:"status",style:{width:"3rem",height:"3rem",color:"#43b8bd"}},[t("span",{class:"visually-hidden"},"Loading...")],-1),H=[E],R={key:1},D={class:"row g-3"},K={class:"card card-att h-100"},G={class:"tag text-white"},J={class:"card-att-img"},O=["src"],Q=t("div",{class:"heart3"},[t("i",{class:"bi bi-heart heart-click"})],-1),W={style:{transform:"rotate(0)"}},X={class:"card-body card-body-att"},Y={class:"card-title d-flex justify-content-between align-items-center card-title-att"},Z={class:"fs-5 fs-xl-4 fw-bold text-primary-700 card-title-att"},tt={class:"card-text card-font-truncate"},et={class:"card-footer text-end border-0"},st={"aria-label":"Page navigation example ",class:"my-10"},at={class:"pagination justify-content-center"},it=["value","onClick"],rt={class:"page-item"};function ot(s,e,l,d,i,c){const k=C("VueLoading"),f=C("router-link");return r(),o(g,null,[m(k,{active:i.isLoading,class:"text-center","z-index":1060},null,8,["active"]),t("div",w,[t("nav",T,[t("ol",L,[t("li",N,[m(f,{to:"/",exact:"","active-class":"active-link"},{default:p(()=>[y("首頁")]),_:1})]),t("li",V,[i.fullPath!=="/TouristAttractions"?(r(),A(f,{key:0,to:{path:"/TouristAttractions"},exact:"","active-class":"active-link"},{default:p(()=>[y(" 南部旅遊景點 ")]),_:1})):(r(),o("span",$," 南部旅遊景點 "))])])]),t("div",j,[t("div",q,[t("div",B,[t("div",F,[I,t("ul",M,[(r(!0),o(g,null,v(c.filterCategory,(a,h)=>(r(),o("li",{class:"nav-item",key:h},[t("a",{class:u(["nav-link p-5 fs-5 link-color d-flex justify-content-between",{"active-category":i.selectedCategory===a}]),"data-name":"item","aria-current":"page",value:a,onClick:_(lt=>c.filterProducts(a),["prevent"])},[y(n(a)+" ",1),t("span",null,n(c.filterCateNum[a]),1)],10,S)]))),128))])])]),t("div",U,[i.status.loadingItem?(r(),o("div",z,H)):(r(),o("div",R,[t("div",D,[(r(!0),o(g,null,v(c.filteredProducts,(a,h)=>(r(),o("div",{class:"col-12 col-md-6 col-lg-4",key:h+123},[t("div",K,[t("span",G,n(a.category),1),t("div",J,[t("img",{src:a.imageUrl,class:"img-fluid",alt:""},null,8,O)]),Q,t("div",W,[t("div",X,[t("div",Y,[t("h4",Z,n(a.title),1)]),t("p",tt,n(c.truncateContent(a.description,65)),1)]),t("div",et,[m(f,{to:{name:"TouristSingleAttraction",params:{category:a.category,title:a.title}},class:"fs-5 stretched-link",type:"button"},{default:p(()=>[y("more")]),_:2},1032,["to"])])])])]))),128))]),t("nav",st,[t("ul",at,[t("li",{class:u(["page-item",{disabled:!i.currentPage||i.currentPage===1}])},[t("a",{class:"page-link page-link-radius-2",href:"",onClick:e[0]||(e[0]=_(a=>c.getAttractions(i.currentPage-1),["prevent"]))},"上一頁")],2),(r(!0),o(g,null,v(i.pageTotal,a=>(r(),o("li",{class:"page-item",key:a+123},[t("a",{class:u(["page-link page-link-0 rounded-0",{active:a===i.currentPage}]),href:"",value:a,onClick:_(h=>c.getAttractions(a),["prevent"])},n(a),11,it)]))),128)),t("li",rt,[t("a",{class:u(["page-link page-link-radius",{disabled:!i.currentPage||i.currentPage===i.pageTotal}]),href:"",onClick:e[1]||(e[1]=_(a=>c.getAttractions(i.currentPage+1),["prevent"]))},"下一頁",2)])])])]))])])])])],64)}const nt=x(P,[["render",ot]]);export{nt as default};
